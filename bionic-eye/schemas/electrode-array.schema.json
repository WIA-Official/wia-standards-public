{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-standards.org/bionic-eye/schemas/electrode-array.schema.json",
  "title": "WIA Bionic Eye Electrode Array",
  "description": "Schema for electrode array configuration and status",
  "type": "object",
  "required": ["arrayId", "type", "physical", "electrodes"],
  "properties": {
    "arrayId": {
      "type": "string",
      "description": "Unique array identifier"
    },
    "type": {
      "type": "string",
      "enum": ["epiretinal", "subretinal", "suprachoroidal", "optic_nerve", "cortical"],
      "description": "Implant type"
    },
    "manufacturer": {
      "type": "string"
    },
    "model": {
      "type": "string"
    },
    "serialNumber": {
      "type": "string"
    },
    "physical": {
      "type": "object",
      "required": ["totalElectrodes", "rows", "columns"],
      "properties": {
        "totalElectrodes": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10000
        },
        "activeElectrodes": {
          "type": "integer",
          "minimum": 0
        },
        "rows": {
          "type": "integer",
          "minimum": 1
        },
        "columns": {
          "type": "integer",
          "minimum": 1
        },
        "electrodeDiameter": {
          "type": "number",
          "minimum": 10,
          "maximum": 1000,
          "description": "Electrode diameter in micrometers"
        },
        "electrodeSpacing": {
          "type": "number",
          "minimum": 50,
          "maximum": 2000,
          "description": "Center-to-center spacing in micrometers"
        },
        "arrayWidth": {
          "type": "number",
          "description": "Array width in millimeters"
        },
        "arrayHeight": {
          "type": "number",
          "description": "Array height in millimeters"
        },
        "material": {
          "type": "string",
          "enum": ["platinum", "platinum_iridium", "iridium_oxide", "titanium_nitride", "pedot", "carbon_nanotube"]
        }
      }
    },
    "electrodes": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["index", "functional"],
        "properties": {
          "index": {
            "type": "integer",
            "minimum": 0
          },
          "gridPosition": {
            "type": "object",
            "properties": {
              "row": { "type": "integer" },
              "col": { "type": "integer" }
            }
          },
          "functional": {
            "type": "boolean"
          },
          "enabled": {
            "type": "boolean"
          },
          "impedance": {
            "type": "number",
            "minimum": 0,
            "description": "Impedance in kOhm"
          },
          "thresholdCurrent": {
            "type": "number",
            "minimum": 0,
            "description": "Perception threshold in microamps"
          },
          "maxSafeCurrent": {
            "type": "number",
            "minimum": 0,
            "description": "Maximum safe current in microamps"
          }
        }
      }
    },
    "placement": {
      "type": "object",
      "properties": {
        "eye": {
          "type": "string",
          "enum": ["left", "right"]
        },
        "implantDate": {
          "type": "string",
          "format": "date"
        },
        "surgeon": {
          "type": "string"
        }
      }
    },
    "safetyLimits": {
      "type": "object",
      "properties": {
        "maxChargeDensity": {
          "type": "number",
          "description": "Maximum charge density in μC/cm²"
        },
        "maxCurrentPerElectrode": {
          "type": "number",
          "description": "Maximum current per electrode in μA"
        },
        "maxTotalCurrent": {
          "type": "number",
          "description": "Maximum total current in mA"
        },
        "maxFrequency": {
          "type": "number",
          "description": "Maximum stimulation frequency in Hz"
        }
      }
    }
  }
}
