{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-standards.org/schemas/haptic/body-location.schema.json",
  "title": "WIA Body Location Schema",
  "description": "JSON Schema for defining body locations and device mappings in the WIA Haptic Standard",
  "version": "1.0.0",

  "definitions": {
    "bodyRegion": {
      "type": "string",
      "enum": [
        "head",
        "neck",
        "shoulder",
        "arm",
        "wrist",
        "hand",
        "finger",
        "torso",
        "waist",
        "leg",
        "foot"
      ],
      "description": "Anatomical region of the body"
    },

    "laterality": {
      "type": "string",
      "enum": ["left", "right", "center", "bilateral"],
      "description": "Side of the body"
    },

    "bodyLocation": {
      "type": "string",
      "enum": [
        "forehead_left",
        "forehead_center",
        "forehead_right",
        "temple_left",
        "temple_right",
        "neck_left",
        "neck_center",
        "neck_right",
        "neck_back",
        "shoulder_left",
        "shoulder_right",
        "upper_arm_left",
        "upper_arm_right",
        "elbow_left",
        "elbow_right",
        "forearm_left",
        "forearm_right",
        "wrist_left_dorsal",
        "wrist_left_volar",
        "wrist_right_dorsal",
        "wrist_right_volar",
        "palm_left",
        "palm_right",
        "back_hand_left",
        "back_hand_right",
        "thumb_left",
        "index_left",
        "middle_left",
        "ring_left",
        "pinky_left",
        "thumb_right",
        "index_right",
        "middle_right",
        "ring_right",
        "pinky_right",
        "chest_left",
        "chest_center",
        "chest_right",
        "abdomen_left",
        "abdomen_center",
        "abdomen_right",
        "back_upper_left",
        "back_upper_center",
        "back_upper_right",
        "back_lower_left",
        "back_lower_center",
        "back_lower_right",
        "waist_left",
        "waist_front",
        "waist_right",
        "waist_back",
        "thigh_left",
        "thigh_right",
        "knee_left",
        "knee_right",
        "calf_left",
        "calf_right",
        "ankle_left",
        "ankle_right",
        "foot_left",
        "foot_right"
      ],
      "description": "Specific body location for haptic actuator placement"
    },

    "bodyLocationInfo": {
      "type": "object",
      "description": "Detailed information about a body location",
      "properties": {
        "id": {
          "$ref": "#/definitions/bodyLocation"
        },
        "name": {
          "type": "string",
          "description": "Human-readable name in English"
        },
        "nameKorean": {
          "type": "string",
          "description": "Human-readable name in Korean"
        },
        "region": {
          "$ref": "#/definitions/bodyRegion"
        },
        "side": {
          "$ref": "#/definitions/laterality"
        },
        "sensitivity": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "description": "Relative tactile sensitivity (1=low, 10=high)"
        },
        "spatialResolution": {
          "type": "number",
          "minimum": 1,
          "maximum": 100,
          "description": "Two-point discrimination threshold in millimeters"
        },
        "coordinates": {
          "$ref": "#/definitions/absoluteCoordinate"
        },
        "commonDevices": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/deviceType"
          },
          "description": "Device types that commonly use this location"
        }
      },
      "required": ["id", "name", "region", "side", "sensitivity"],
      "additionalProperties": false
    },

    "absoluteCoordinate": {
      "type": "object",
      "description": "Normalized 3D coordinates relative to body",
      "properties": {
        "vertical": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Vertical position (0=top of head, 1=feet)"
        },
        "horizontal": {
          "type": "number",
          "minimum": -1,
          "maximum": 1,
          "description": "Horizontal position (-1=far left, 0=center, 1=far right)"
        },
        "depth": {
          "type": "number",
          "minimum": -1,
          "maximum": 1,
          "description": "Front-back position (-1=back, 0=side, 1=front)"
        }
      },
      "required": ["vertical", "horizontal", "depth"],
      "additionalProperties": false
    },

    "relativePosition": {
      "type": "object",
      "description": "Position relative to an anchor location",
      "properties": {
        "anchor": {
          "$ref": "#/definitions/bodyLocation"
        },
        "offsetX": {
          "type": "number",
          "description": "Lateral offset in centimeters"
        },
        "offsetY": {
          "type": "number",
          "description": "Vertical offset in centimeters"
        },
        "offsetZ": {
          "type": "number",
          "description": "Depth offset in centimeters"
        }
      },
      "required": ["anchor"],
      "additionalProperties": false
    },

    "subLocationPosition": {
      "type": "object",
      "description": "Sub-location precision within a body location",
      "properties": {
        "baseLocation": {
          "$ref": "#/definitions/bodyLocation"
        },
        "segment": {
          "type": "string",
          "enum": ["proximal", "medial", "distal"],
          "description": "Segment for finger locations"
        },
        "zone": {
          "type": "string",
          "enum": ["inner", "center", "outer"],
          "description": "Zone within larger areas"
        }
      },
      "required": ["baseLocation"],
      "additionalProperties": false
    },

    "deviceType": {
      "type": "string",
      "enum": [
        "smartwatch",
        "wristband",
        "bracelet",
        "haptic_glove",
        "ring",
        "handheld",
        "armband",
        "headband",
        "smart_glasses",
        "headset",
        "vest",
        "belt",
        "shirt",
        "full_suit",
        "insole",
        "anklet",
        "smartphone",
        "tablet",
        "cane"
      ],
      "description": "Type of haptic-enabled device"
    },

    "deviceLocationMapping": {
      "type": "object",
      "description": "Mapping between device type and body locations",
      "properties": {
        "deviceType": {
          "$ref": "#/definitions/deviceType"
        },
        "locations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "minItems": 1,
          "description": "Body locations covered by this device"
        },
        "actuatorCount": {
          "type": "object",
          "properties": {
            "min": {
              "type": "integer",
              "minimum": 1
            },
            "typical": {
              "type": "integer",
              "minimum": 1
            },
            "max": {
              "type": "integer",
              "minimum": 1
            }
          },
          "required": ["min", "typical", "max"],
          "additionalProperties": false
        },
        "primaryUseCase": {
          "type": "string",
          "description": "Main use case for this device configuration"
        }
      },
      "required": ["deviceType", "locations", "actuatorCount"],
      "additionalProperties": false
    },

    "direction": {
      "type": "string",
      "enum": ["forward", "backward", "left", "right", "up", "down"],
      "description": "Direction of movement or indication"
    },

    "directionalMapping": {
      "type": "object",
      "description": "Mapping between direction and body locations",
      "properties": {
        "direction": {
          "$ref": "#/definitions/direction"
        },
        "primaryLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "minItems": 1,
          "description": "Primary locations for indicating this direction"
        },
        "alternateLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Fallback locations if primary unavailable"
        },
        "pattern": {
          "type": "string",
          "description": "Suggested haptic pattern description"
        }
      },
      "required": ["direction", "primaryLocations"],
      "additionalProperties": false
    },

    "clockPosition": {
      "type": "object",
      "description": "Clock-face position mapping for 360° navigation",
      "properties": {
        "position": {
          "type": "integer",
          "minimum": 1,
          "maximum": 12,
          "description": "Clock position (1-12)"
        },
        "degrees": {
          "type": "integer",
          "minimum": 0,
          "maximum": 359,
          "description": "Angle in degrees (0=12 o'clock)"
        },
        "vestLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Vest actuator locations for this position"
        },
        "beltLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Belt actuator locations for this position"
        }
      },
      "required": ["position", "degrees"],
      "additionalProperties": false
    },

    "apparentMotionPattern": {
      "type": "object",
      "description": "Pattern creating illusion of movement across body",
      "properties": {
        "name": {
          "type": "string"
        },
        "locations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "minItems": 2,
          "description": "Ordered locations for sequential activation"
        },
        "timing": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 0
          },
          "description": "Onset times in milliseconds"
        },
        "durations": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 0
          },
          "description": "Per-actuator durations in milliseconds"
        },
        "intensities": {
          "type": "array",
          "items": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "description": "Per-actuator intensities (0.0-1.0)"
        }
      },
      "required": ["name", "locations", "timing"],
      "additionalProperties": false
    },

    "phantomSensationPattern": {
      "type": "object",
      "description": "Pattern creating sensation between two actuator locations",
      "properties": {
        "name": {
          "type": "string"
        },
        "locations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "minItems": 2,
          "maxItems": 2,
          "description": "Two locations for phantom sensation"
        },
        "intensityRatio": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.5,
          "description": "Ratio determining perceived location (0=first, 1=second, 0.5=center)"
        },
        "synchronize": {
          "type": "boolean",
          "default": true,
          "description": "Whether to synchronize both actuators"
        }
      },
      "required": ["name", "locations"],
      "additionalProperties": false
    },

    "sensitivityAdaptation": {
      "type": "object",
      "description": "Adaptation settings for reduced sensitivity conditions",
      "properties": {
        "condition": {
          "type": "string",
          "description": "Name of the condition (e.g., 'diabetic_neuropathy')"
        },
        "affectedLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Locations affected by reduced sensitivity"
        },
        "compensation": {
          "type": "object",
          "properties": {
            "intensityMultiplier": {
              "type": "number",
              "minimum": 1,
              "maximum": 3,
              "default": 1.5
            },
            "durationMultiplier": {
              "type": "number",
              "minimum": 1,
              "maximum": 3,
              "default": 1.3
            },
            "useAlternateLocations": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/bodyLocation"
              }
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["condition", "affectedLocations", "compensation"],
      "additionalProperties": false
    },

    "userCalibration": {
      "type": "object",
      "description": "User-specific calibration settings",
      "properties": {
        "userId": {
          "type": "string"
        },
        "perceptionThresholds": {
          "type": "object",
          "additionalProperties": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "description": "Per-location minimum perceptible intensity"
        },
        "comfortMaximum": {
          "type": "object",
          "additionalProperties": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "description": "Per-location maximum comfortable intensity"
        },
        "unavailableLocations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Locations not available (injury, prosthetic, etc.)"
        },
        "alternatePreferences": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/bodyLocation"
          },
          "description": "Preferred alternate locations for unavailable ones"
        }
      },
      "required": ["userId"],
      "additionalProperties": false
    },

    "fallbackStrategy": {
      "type": "object",
      "description": "Fallback strategy when a location is unavailable",
      "properties": {
        "missingLocation": {
          "$ref": "#/definitions/bodyLocation"
        },
        "fallbackChain": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/bodyLocation"
          },
          "minItems": 1,
          "description": "Ordered list of fallback locations"
        },
        "patternModification": {
          "type": "string",
          "description": "How to modify the pattern for fallback"
        }
      },
      "required": ["missingLocation", "fallbackChain"],
      "additionalProperties": false
    }
  },

  "type": "object",
  "properties": {
    "$schema": {
      "type": "string"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "locations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/bodyLocationInfo"
      },
      "description": "Library of body location definitions"
    },
    "deviceMappings": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/deviceLocationMapping"
      },
      "description": "Device to location mappings"
    },
    "directionalMappings": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/directionalMapping"
      },
      "description": "Direction to location mappings"
    },
    "clockPositions": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/clockPosition"
      },
      "description": "Clock-face position mappings for 360° navigation"
    },
    "motionPatterns": {
      "type": "object",
      "properties": {
        "apparentMotion": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/apparentMotionPattern"
          }
        },
        "phantomSensation": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phantomSensationPattern"
          }
        }
      },
      "additionalProperties": false
    },
    "adaptations": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/sensitivityAdaptation"
      },
      "description": "Sensitivity adaptations for various conditions"
    },
    "fallbackStrategies": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/fallbackStrategy"
      },
      "description": "Fallback strategies for unavailable locations"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "author": { "type": "string" },
        "license": { "type": "string" },
        "created": { "type": "string", "format": "date-time" },
        "modified": { "type": "string", "format": "date-time" }
      },
      "additionalProperties": true
    }
  },
  "required": ["version"],
  "additionalProperties": false
}
