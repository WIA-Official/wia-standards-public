{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia-standards.org/voice/schemas/translation-response.schema.json",
  "title": "TranslationResponse",
  "description": "Response for voice-to-sign language translation",
  "type": "object",
  "required": ["request_id", "response_id", "timestamp", "status", "processing"],
  "properties": {
    "request_id": {
      "type": "string",
      "description": "Reference to original request"
    },
    "response_id": {
      "type": "string",
      "description": "Unique response identifier"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "status": {
      "type": "string",
      "enum": ["success", "partial", "error"],
      "description": "Response status"
    },
    "error": {
      "$ref": "#/$defs/ErrorInfo"
    },
    "transcript": {
      "$ref": "transcription-result.schema.json"
    },
    "gloss": {
      "$ref": "sign-gloss.schema.json"
    },
    "notation": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/SignNotation"
      }
    },
    "pose": {
      "$ref": "sign-pose.schema.json"
    },
    "render": {
      "$ref": "#/$defs/RenderOutput"
    },
    "processing": {
      "$ref": "#/$defs/ProcessingSummary"
    }
  },
  "$defs": {
    "ErrorInfo": {
      "type": "object",
      "required": ["code", "message"],
      "properties": {
        "code": {
          "type": "string",
          "description": "Error code"
        },
        "message": {
          "type": "string",
          "description": "Human-readable error message"
        },
        "details": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "SignNotation": {
      "type": "object",
      "required": ["gloss_id", "gloss", "notation_type", "manual"],
      "properties": {
        "gloss_id": {
          "type": "string"
        },
        "gloss": {
          "type": "string"
        },
        "notation_type": {
          "type": "string",
          "enum": ["hamnosys", "sigml", "custom"]
        },
        "manual": {
          "$ref": "#/$defs/ManualComponent"
        },
        "non_manual": {
          "$ref": "#/$defs/NonManualComponent"
        }
      }
    },
    "ManualComponent": {
      "type": "object",
      "required": ["dominant", "movement"],
      "properties": {
        "dominant": {
          "$ref": "#/$defs/HandConfiguration"
        },
        "non_dominant": {
          "$ref": "#/$defs/HandConfiguration"
        },
        "hand_relationship": {
          "type": "string",
          "enum": ["parallel", "crossed", "interlocked", "stacked", "mirror"]
        },
        "movement": {
          "$ref": "#/$defs/MovementComponent"
        }
      }
    },
    "HandConfiguration": {
      "type": "object",
      "required": ["handshape", "palm_orientation", "finger_direction", "location"],
      "properties": {
        "handshape": {
          "type": "string"
        },
        "thumb": {
          "type": "string",
          "enum": ["out", "across", "tucked"]
        },
        "palm_orientation": {
          "$ref": "#/$defs/Orientation"
        },
        "finger_direction": {
          "$ref": "#/$defs/Orientation"
        },
        "location": {
          "$ref": "#/$defs/BodyLocation"
        },
        "contact": {
          "type": "string",
          "enum": ["touch", "grasp", "brush", "none"]
        }
      }
    },
    "Orientation": {
      "type": "object",
      "required": ["direction"],
      "properties": {
        "direction": {
          "type": "string",
          "enum": ["up", "down", "left", "right", "forward", "back", "up_left", "up_right", "down_left", "down_right"]
        },
        "rotation_deg": {
          "type": "number"
        }
      }
    },
    "BodyLocation": {
      "type": "object",
      "required": ["region"],
      "properties": {
        "region": {
          "type": "string",
          "enum": ["head", "forehead", "eyes", "nose", "mouth", "chin", "cheek", "ear", "neck", "shoulder", "chest", "stomach", "arm", "elbow", "wrist", "neutral_space"]
        },
        "specific": {
          "type": "string"
        },
        "offset": {
          "type": "object",
          "properties": {
            "x": { "type": "number" },
            "y": { "type": "number" },
            "z": { "type": "number" }
          }
        }
      }
    },
    "MovementComponent": {
      "type": "object",
      "required": ["path", "dynamics"],
      "properties": {
        "path": {
          "$ref": "#/$defs/MovementPath"
        },
        "dynamics": {
          "$ref": "#/$defs/MovementDynamics"
        },
        "repetition": {
          "$ref": "#/$defs/RepetitionInfo"
        }
      }
    },
    "MovementPath": {
      "type": "object",
      "required": ["type", "size"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["straight", "arc", "circle", "zigzag", "wave", "spiral", "none"]
        },
        "direction": {
          "type": "string"
        },
        "size": {
          "type": "string",
          "enum": ["small", "medium", "large"]
        },
        "arc_direction": {
          "type": "string",
          "enum": ["clockwise", "counterclockwise"]
        }
      }
    },
    "MovementDynamics": {
      "type": "object",
      "required": ["speed", "tension"],
      "properties": {
        "speed": {
          "type": "string",
          "enum": ["slow", "normal", "fast"]
        },
        "tension": {
          "type": "string",
          "enum": ["relaxed", "normal", "tense"]
        },
        "acceleration": {
          "type": "string",
          "enum": ["constant", "accelerate", "decelerate"]
        }
      }
    },
    "RepetitionInfo": {
      "type": "object",
      "required": ["count", "bidirectional"],
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 1
        },
        "bidirectional": {
          "type": "boolean"
        }
      }
    },
    "NonManualComponent": {
      "type": "object",
      "properties": {
        "facial": {
          "$ref": "#/$defs/FacialExpression"
        },
        "mouth": {
          "$ref": "#/$defs/MouthComponent"
        },
        "eyes": {
          "$ref": "#/$defs/EyeComponent"
        },
        "head": {
          "$ref": "#/$defs/HeadComponent"
        },
        "body": {
          "$ref": "#/$defs/BodyComponent"
        }
      }
    },
    "FacialExpression": {
      "type": "object",
      "required": ["expression", "intensity"],
      "properties": {
        "expression": {
          "type": "string",
          "enum": ["neutral", "raised_brows", "furrowed_brows", "squint", "wide_eyes", "smile", "frown", "pursed_lips"]
        },
        "intensity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "MouthComponent": {
      "type": "object",
      "properties": {
        "mouthing": {
          "type": "string"
        },
        "gesture": {
          "type": "string",
          "enum": ["neutral", "pah", "cha", "mm", "th", "puff_cheeks", "bite_lip"]
        }
      }
    },
    "EyeComponent": {
      "type": "object",
      "required": ["gaze"],
      "properties": {
        "gaze": {
          "type": "string",
          "enum": ["forward", "up", "down", "left", "right", "addressee", "referent"]
        },
        "blink": {
          "type": "boolean"
        },
        "squint": {
          "type": "boolean"
        }
      }
    },
    "HeadComponent": {
      "type": "object",
      "required": ["movement"],
      "properties": {
        "movement": {
          "type": "string",
          "enum": ["none", "nod", "shake", "tilt_forward", "tilt_back"]
        },
        "tilt": {
          "type": "string",
          "enum": ["left", "right", "none"]
        }
      }
    },
    "BodyComponent": {
      "type": "object",
      "properties": {
        "lean": {
          "type": "string",
          "enum": ["forward", "back", "left", "right", "none"]
        },
        "shoulder_raise": {
          "type": "string",
          "enum": ["left", "right", "both", "none"]
        }
      }
    },
    "RenderOutput": {
      "type": "object",
      "required": ["pose_sequence_id", "render_id", "timestamp", "format", "resolution", "frame_rate", "duration_ms"],
      "properties": {
        "pose_sequence_id": {
          "type": "string"
        },
        "render_id": {
          "type": "string"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "format": {
          "$ref": "#/$defs/OutputFormat"
        },
        "resolution": {
          "$ref": "#/$defs/Resolution"
        },
        "frame_rate": {
          "type": "integer"
        },
        "duration_ms": {
          "type": "number"
        },
        "file_size_bytes": {
          "type": "integer"
        },
        "data_url": {
          "type": "string",
          "format": "uri"
        },
        "avatar": {
          "$ref": "#/$defs/AvatarInfo"
        },
        "quality_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "OutputFormat": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["video", "animation", "streaming"]
        },
        "codec": {
          "type": "string"
        },
        "container": {
          "type": "string"
        }
      }
    },
    "Resolution": {
      "type": "object",
      "required": ["width", "height"],
      "properties": {
        "width": {
          "type": "integer"
        },
        "height": {
          "type": "integer"
        }
      }
    },
    "AvatarInfo": {
      "type": "object",
      "required": ["avatar_id", "name", "style"],
      "properties": {
        "avatar_id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "style": {
          "type": "string",
          "enum": ["realistic", "stylized", "cartoon", "minimal"]
        }
      }
    },
    "ProcessingSummary": {
      "type": "object",
      "required": ["total_time_ms"],
      "properties": {
        "total_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "asr_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "translation_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "pose_generation_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "render_time_ms": {
          "type": "number",
          "minimum": 0
        }
      }
    }
  }
}
