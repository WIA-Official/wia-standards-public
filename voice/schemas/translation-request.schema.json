{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia-standards.org/voice/schemas/translation-request.schema.json",
  "title": "TranslationRequest",
  "description": "Request for voice-to-sign language translation",
  "type": "object",
  "required": ["request_id", "target_language", "output"],
  "properties": {
    "request_id": {
      "type": "string",
      "description": "Unique request identifier"
    },
    "audio": {
      "$ref": "audio-input.schema.json",
      "description": "Audio input (mutually exclusive with text)"
    },
    "text": {
      "$ref": "#/$defs/TextInput",
      "description": "Text input (mutually exclusive with audio)"
    },
    "target_language": {
      "type": "string",
      "enum": ["ASL", "BSL", "LSF", "DGS", "JSL", "KSL", "CSL", "Auslan", "NZSL"],
      "description": "Target sign language"
    },
    "output": {
      "$ref": "#/$defs/OutputPreferences"
    },
    "options": {
      "$ref": "#/$defs/TranslationOptions"
    }
  },
  "oneOf": [
    { "required": ["audio"] },
    { "required": ["text"] }
  ],
  "$defs": {
    "TextInput": {
      "type": "object",
      "required": ["text", "language"],
      "properties": {
        "text": {
          "type": "string",
          "minLength": 1,
          "maxLength": 10000
        },
        "language": {
          "type": "string",
          "pattern": "^[a-z]{2}$",
          "description": "ISO 639-1 language code"
        }
      }
    },
    "OutputPreferences": {
      "type": "object",
      "required": ["include_transcript", "include_gloss", "include_notation", "include_pose", "include_render"],
      "properties": {
        "include_transcript": {
          "type": "boolean",
          "description": "Include ASR transcription result"
        },
        "include_gloss": {
          "type": "boolean",
          "description": "Include sign gloss sequence"
        },
        "include_notation": {
          "type": "boolean",
          "description": "Include HamNoSys/SiGML notation"
        },
        "include_pose": {
          "type": "boolean",
          "description": "Include 3D pose data"
        },
        "include_render": {
          "type": "boolean",
          "description": "Include rendered video/animation"
        },
        "render_settings": {
          "$ref": "#/$defs/RenderSettings"
        }
      }
    },
    "RenderSettings": {
      "type": "object",
      "properties": {
        "format": {
          "type": "string",
          "enum": ["video", "animation", "streaming"]
        },
        "resolution": {
          "$ref": "#/$defs/Resolution"
        },
        "frame_rate": {
          "type": "integer",
          "enum": [24, 25, 30, 50, 60]
        },
        "avatar_id": {
          "type": "string"
        }
      }
    },
    "Resolution": {
      "type": "object",
      "required": ["width", "height"],
      "properties": {
        "width": {
          "type": "integer",
          "minimum": 320,
          "maximum": 3840
        },
        "height": {
          "type": "integer",
          "minimum": 240,
          "maximum": 2160
        }
      }
    },
    "TranslationOptions": {
      "type": "object",
      "properties": {
        "asr_model": {
          "type": "string",
          "description": "Specific ASR model to use"
        },
        "language_detection": {
          "type": "boolean",
          "default": true,
          "description": "Enable automatic language detection"
        },
        "translation_model": {
          "type": "string",
          "description": "Specific translation model to use"
        },
        "formality_level": {
          "type": "string",
          "enum": ["formal", "informal", "neutral"],
          "default": "neutral"
        },
        "streaming": {
          "type": "boolean",
          "default": false,
          "description": "Enable streaming mode"
        },
        "chunk_duration_ms": {
          "type": "integer",
          "minimum": 100,
          "maximum": 5000,
          "default": 500,
          "description": "Chunk duration for streaming"
        }
      }
    }
  }
}
