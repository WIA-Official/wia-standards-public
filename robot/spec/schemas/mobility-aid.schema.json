{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/robot/v1/mobility-aid.schema.json",
  "title": "WIA Mobility Aid Robot Data Schema",
  "description": "Schema for mobility aid robot data (wheelchairs, walkers, etc.)",
  "allOf": [
    { "$ref": "device.schema.json" },
    {
      "properties": {
        "device": {
          "properties": {
            "type": { "const": "mobility_aid" }
          }
        },
        "spec": {
          "$ref": "#/definitions/MobilityAidSpec"
        }
      }
    }
  ],
  "definitions": {
    "MobilityAidSpec": {
      "type": "object",
      "required": ["mobility_type", "autonomous_mode", "navigation", "motion", "sensors", "user_interface", "seating"],
      "properties": {
        "mobility_type": {
          "type": "string",
          "enum": ["powered_wheelchair", "smart_walker", "mobility_scooter", "stair_climber"]
        },
        "autonomous_mode": {
          "type": "string",
          "enum": ["manual", "semi_autonomous", "fully_autonomous"]
        },
        "navigation": {
          "$ref": "#/definitions/NavigationData"
        },
        "motion": {
          "$ref": "#/definitions/MotionData"
        },
        "sensors": {
          "$ref": "#/definitions/SensorData"
        },
        "user_interface": {
          "$ref": "#/definitions/UserInterface"
        },
        "seating": {
          "$ref": "#/definitions/SeatingData"
        },
        "environment": {
          "$ref": "#/definitions/EnvironmentData"
        }
      }
    },
    "NavigationData": {
      "type": "object",
      "required": ["current_pose", "path_status", "localization_confidence"],
      "properties": {
        "current_pose": { "$ref": "#/definitions/Pose2D" },
        "destination": {
          "type": "object",
          "properties": {
            "x": { "type": "number" },
            "y": { "type": "number" },
            "name": { "type": "string" }
          }
        },
        "path_status": {
          "type": "string",
          "enum": ["idle", "planning", "navigating", "arrived", "blocked"]
        },
        "distance_to_goal_m": { "type": "number" },
        "eta_seconds": { "type": "number" },
        "map_id": { "type": "string" },
        "localization_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "MotionData": {
      "type": "object",
      "required": ["velocity", "max_velocity", "acceleration", "odometry"],
      "properties": {
        "velocity": {
          "type": "object",
          "required": ["linear", "angular"],
          "properties": {
            "linear": { "type": "number" },
            "angular": { "type": "number" }
          }
        },
        "max_velocity": {
          "type": "object",
          "properties": {
            "linear": { "type": "number" },
            "angular": { "type": "number" }
          }
        },
        "acceleration": {
          "type": "object",
          "properties": {
            "linear": { "type": "number" },
            "angular": { "type": "number" }
          }
        },
        "odometry": {
          "type": "object",
          "properties": {
            "distance_traveled_m": { "type": "number" },
            "heading_deg": { "type": "number" }
          }
        }
      }
    },
    "SensorData": {
      "type": "object",
      "properties": {
        "lidar": {
          "type": "object",
          "properties": {
            "range_m": { "type": "number" },
            "fov_deg": { "type": "number" },
            "obstacle_detected": { "type": "boolean" },
            "closest_obstacle_m": { "type": "number" },
            "obstacle_direction_deg": { "type": "number" }
          }
        },
        "ultrasonic": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "location": { "type": "string" },
              "distance_m": { "type": "number" },
              "obstacle_detected": { "type": "boolean" }
            }
          }
        },
        "cameras": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "location": { "type": "string" },
              "resolution": { "type": "string" },
              "frame_rate_fps": { "type": "number" },
              "depth_enabled": { "type": "boolean" },
              "objects_detected": { "type": "integer" }
            }
          }
        },
        "cliff_sensors": {
          "type": "array",
          "items": { "type": "boolean" }
        },
        "bump_sensors": {
          "type": "array",
          "items": { "type": "boolean" }
        }
      }
    },
    "UserInterface": {
      "type": "object",
      "required": ["input_method", "override_active", "input_sensitivity"],
      "properties": {
        "input_method": {
          "type": "string",
          "enum": ["joystick", "head_tracker", "voice", "eye_gaze", "sip_puff", "switch"]
        },
        "command": {
          "type": "object",
          "properties": {
            "type": { "type": "string" },
            "value": { "type": "number" }
          }
        },
        "override_active": { "type": "boolean" },
        "input_sensitivity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "SeatingData": {
      "type": "object",
      "required": ["tilt_angle_deg", "recline_angle_deg", "seat_elevation_cm", "leg_rest_angle_deg", "armrest_position"],
      "properties": {
        "tilt_angle_deg": { "type": "number" },
        "recline_angle_deg": { "type": "number" },
        "seat_elevation_cm": { "type": "number" },
        "leg_rest_angle_deg": { "type": "number" },
        "armrest_position": {
          "type": "string",
          "enum": ["up", "down", "adjustable"]
        },
        "pressure_relief_active": { "type": "boolean" }
      }
    },
    "EnvironmentData": {
      "type": "object",
      "properties": {
        "indoor": { "type": "boolean" },
        "surface_type": {
          "type": "string",
          "enum": ["smooth", "carpet", "outdoor", "gravel"]
        },
        "incline_deg": { "type": "number" },
        "detected_obstacles": { "type": "integer" }
      }
    },
    "Pose2D": {
      "type": "object",
      "required": ["x", "y", "theta"],
      "properties": {
        "x": { "type": "number" },
        "y": { "type": "number" },
        "theta": { "type": "number" }
      }
    }
  }
}
