{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/robot/v1/care-robot.schema.json",
  "title": "WIA Care Robot Data Schema",
  "description": "Schema for care and companion robot data",
  "allOf": [
    { "$ref": "device.schema.json" },
    {
      "properties": {
        "device": {
          "properties": {
            "type": { "const": "care_robot" }
          }
        },
        "spec": {
          "$ref": "#/definitions/CareRobotSpec"
        }
      }
    }
  ],
  "definitions": {
    "CareRobotSpec": {
      "type": "object",
      "required": ["care_type", "interaction", "tasks", "navigation"],
      "properties": {
        "care_type": {
          "type": "string",
          "enum": ["elderly_companion", "pediatric", "dementia_care", "hospital_assistant", "service_robot"]
        },
        "interaction": {
          "$ref": "#/definitions/InteractionData"
        },
        "emotion_recognition": {
          "$ref": "#/definitions/EmotionData"
        },
        "vital_monitoring": {
          "$ref": "#/definitions/VitalMonitoring"
        },
        "tasks": {
          "type": "array",
          "items": { "$ref": "#/definitions/CareTask" }
        },
        "navigation": {
          "$ref": "#/definitions/NavigationData"
        },
        "voice_interaction": {
          "$ref": "#/definitions/VoiceInteraction"
        }
      }
    },
    "InteractionData": {
      "type": "object",
      "required": ["mode", "active_duration_s", "engagement_level", "language"],
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["conversation", "entertainment", "reminder", "monitoring", "assistance", "idle"]
        },
        "active_duration_s": { "type": "number" },
        "engagement_level": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "last_interaction": {
          "type": "string",
          "format": "date-time"
        },
        "language": { "type": "string" }
      }
    },
    "EmotionData": {
      "type": "object",
      "required": ["detected_emotion", "confidence", "face_detected"],
      "properties": {
        "detected_emotion": {
          "type": "string",
          "enum": ["happy", "sad", "angry", "fearful", "surprised", "neutral", "content"]
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "valence": {
          "type": "number",
          "minimum": -1,
          "maximum": 1
        },
        "arousal": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "face_detected": { "type": "boolean" }
      }
    },
    "VitalMonitoring": {
      "type": "object",
      "required": ["fall_detected", "activity_level"],
      "properties": {
        "heart_rate_bpm": { "type": "number" },
        "respiratory_rate": { "type": "number" },
        "body_temp_c": { "type": "number" },
        "blood_pressure": {
          "type": "object",
          "properties": {
            "systolic": { "type": "number" },
            "diastolic": { "type": "number" }
          }
        },
        "oxygen_saturation": { "type": "number" },
        "fall_detected": { "type": "boolean" },
        "activity_level": {
          "type": "string",
          "enum": ["resting", "light", "moderate", "vigorous"]
        },
        "sleep_quality": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "CareTask": {
      "type": "object",
      "required": ["task_id", "type", "description", "status", "confirmation"],
      "properties": {
        "task_id": { "type": "string" },
        "type": {
          "type": "string",
          "enum": [
            "medication_reminder",
            "appointment_reminder",
            "activity_prompt",
            "meal_reminder",
            "hydration_reminder",
            "exercise_prompt",
            "social_interaction",
            "emergency_alert"
          ]
        },
        "description": { "type": "string" },
        "scheduled_time": {
          "type": "string",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "enum": ["pending", "in_progress", "completed", "skipped", "failed"]
        },
        "confirmation": { "type": "boolean" },
        "notes": { "type": "string" }
      }
    },
    "NavigationData": {
      "type": "object",
      "required": ["following_user", "navigation_status"],
      "properties": {
        "current_room": { "type": "string" },
        "current_pose": { "$ref": "#/definitions/Pose2D" },
        "following_user": { "type": "boolean" },
        "distance_to_user_m": { "type": "number" },
        "map_id": { "type": "string" },
        "navigation_status": {
          "type": "string",
          "enum": ["idle", "navigating", "arrived", "blocked"]
        }
      }
    },
    "VoiceInteraction": {
      "type": "object",
      "properties": {
        "last_utterance": { "type": "string" },
        "asr_confidence": { "type": "number" },
        "tts_active": { "type": "boolean" },
        "wake_word_detected": { "type": "boolean" }
      }
    },
    "Pose2D": {
      "type": "object",
      "required": ["x", "y", "theta"],
      "properties": {
        "x": { "type": "number" },
        "y": { "type": "number" },
        "theta": { "type": "number" }
      }
    }
  }
}
