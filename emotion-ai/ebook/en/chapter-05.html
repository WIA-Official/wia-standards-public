<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 5: Phase 2 - API Interface - WIA Emotion AI Standard Ebook</title>
</head>
<body>

<p><a href="index.html">ðŸ’— WIA Emotion AI Standard Ebook</a> | Chapter 5 of 8</p>

<hr>

<h1>ðŸ’— Chapter 5: Phase 2 - API Interface</h1>

<blockquote>
<p><strong>Hongik Ingan (å¼˜ç›Šäººé–“)</strong></p>
<p>"Benefit All Humanity"</p>
<p>A well-designed API enables developers to easily integrate emotion recognition into their applications, regardless of the underlying implementation.</p>
</blockquote>

<hr>

<h2>5.1 API Design Principles</h2>

<h3>5.1.1 Core Principles</h3>

<table border="1" cellpadding="10">
    <thead>
        <tr>
            <th>Principle</th>
            <th>Implementation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>RESTful</td>
            <td>Standard HTTP methods, resource-based URLs</td>
        </tr>
        <tr>
            <td>JSON</td>
            <td>All requests and responses in JSON format</td>
        </tr>
        <tr>
            <td>Versioned</td>
            <td>API version in URL path (/v1/)</td>
        </tr>
        <tr>
            <td>Authenticated</td>
            <td>API keys or OAuth 2.0</td>
        </tr>
        <tr>
            <td>Rate Limited</td>
            <td>Clear rate limits with headers</td>
        </tr>
    </tbody>
</table>

<h3>5.1.2 Base URL</h3>

<pre>
Production: https://api.wiastandards.com/emotion-ai/v1
Staging:    https://api-staging.wiastandards.com/emotion-ai/v1
</pre>

<hr>

<h2>5.2 Authentication</h2>

<h3>5.2.1 API Key Authentication</h3>

<pre>
Header: X-WIA-API-Key: your_api_key_here

Example Request:
curl -X POST https://api.wiastandards.com/emotion-ai/v1/analyze/face \
  -H "X-WIA-API-Key: sk_live_abc123" \
  -H "Content-Type: application/json" \
  -d '{"image_url": "https://example.com/face.jpg"}'
</pre>

<h3>5.2.2 OAuth 2.0 (Optional)</h3>

<pre>
Header: Authorization: Bearer &lt;access_token&gt;

Token Endpoint: POST /oauth/token
Scopes:
  - emotion:read    - Read emotion analysis results
  - emotion:analyze - Submit content for analysis
  - emotion:stream  - Real-time streaming access
</pre>

<hr>

<h2>5.3 Facial Emotion Analysis API</h2>

<h3>5.3.1 Analyze Face Image</h3>

<pre>
POST /v1/analyze/face

Request Body:
{
    "image_url": "https://example.com/face.jpg",
    // OR
    "image_base64": "data:image/jpeg;base64,/9j/4AAQ...",

    "options": {
        "return_action_units": true,
        "return_dimensions": true,
        "return_landmarks": false,
        "min_face_size": 50,
        "max_faces": 5
    }
}

Response (200 OK):
{
    "request_id": "req_abc123",
    "processing_time_ms": 145,
    "faces": [
        {
            "face_id": 0,
            "bbox": { "x": 120, "y": 80, "width": 200, "height": 250 },
            "emotions": {
                "primary": { "label": "happiness", "confidence": 0.87 },
                "all": [
                    { "label": "happiness", "confidence": 0.87 },
                    { "label": "neutral", "confidence": 0.08 },
                    { "label": "surprise", "confidence": 0.05 }
                ]
            },
            "dimensions": {
                "valence": 0.72,
                "arousal": 0.45
            },
            "action_units": [
                { "au": "AU6", "intensity": 0.8 },
                { "au": "AU12", "intensity": 0.9 }
            ]
        }
    ]
}
</pre>

<h3>5.3.2 Analyze Video Frame</h3>

<pre>
POST /v1/analyze/face/video

Request Body:
{
    "video_url": "https://example.com/video.mp4",
    // OR
    "frames_base64": ["data:image/jpeg;base64,...", ...],

    "options": {
        "sample_rate": 5,  // Analyze every 5th frame
        "start_time_ms": 0,
        "end_time_ms": 10000,
        "track_faces": true
    }
}

Response (200 OK):
{
    "request_id": "req_video123",
    "duration_ms": 10000,
    "frame_count": 60,
    "analyzed_frames": 12,
    "timeline": [
        {
            "timestamp_ms": 0,
            "faces": [{ ... }]
        },
        {
            "timestamp_ms": 833,
            "faces": [{ ... }]
        }
    ],
    "summary": {
        "dominant_emotion": "happiness",
        "average_valence": 0.65,
        "average_arousal": 0.42,
        "emotion_transitions": 3
    }
}
</pre>

<hr>

<h2>5.4 Voice Emotion Analysis API</h2>

<h3>5.4.1 Analyze Audio</h3>

<pre>
POST /v1/analyze/voice

Request Body:
{
    "audio_url": "https://example.com/audio.wav",
    // OR
    "audio_base64": "data:audio/wav;base64,...",

    "options": {
        "language": "en-US",
        "return_transcript": true,
        "return_prosody": true,
        "segment_by": "utterance"
    }
}

Response (200 OK):
{
    "request_id": "req_voice456",
    "duration_ms": 5500,
    "language_detected": "en-US",
    "transcript": "I'm really excited about this opportunity!",

    "emotions": {
        "primary": { "label": "excitement", "confidence": 0.82 },
        "all": [
            { "label": "excitement", "confidence": 0.82 },
            { "label": "happiness", "confidence": 0.65 },
            { "label": "neutral", "confidence": 0.12 }
        ]
    },

    "dimensions": {
        "valence": 0.78,
        "arousal": 0.85
    },

    "prosody": {
        "pitch_mean_hz": 185.5,
        "pitch_range_hz": 120.3,
        "intensity_db": 68.2,
        "speech_rate_wpm": 145,
        "pause_ratio": 0.12
    },

    "segments": [
        {
            "start_ms": 0,
            "end_ms": 2500,
            "text": "I'm really excited",
            "emotion": "excitement",
            "confidence": 0.85
        },
        {
            "start_ms": 2500,
            "end_ms": 5500,
            "text": "about this opportunity!",
            "emotion": "happiness",
            "confidence": 0.78
        }
    ]
}
</pre>

<h3>5.4.2 Real-time Voice Analysis</h3>

<pre>
POST /v1/analyze/voice/stream

Request: WebSocket upgrade (see Chapter 6)

Initial Message:
{
    "type": "config",
    "sample_rate": 16000,
    "encoding": "LINEAR16",
    "language": "en-US"
}

Audio Chunks:
Binary audio data (PCM)

Response Messages:
{
    "type": "partial",
    "timestamp_ms": 1500,
    "emotion": { "label": "neutral", "confidence": 0.7 }
}

{
    "type": "final",
    "segment": {
        "start_ms": 0,
        "end_ms": 3000,
        "text": "Hello, how are you?",
        "emotion": { "label": "happiness", "confidence": 0.82 }
    }
}
</pre>

<hr>

<h2>5.5 Text Sentiment Analysis API</h2>

<h3>5.5.1 Analyze Text</h3>

<pre>
POST /v1/analyze/text

Request Body:
{
    "text": "I absolutely love this product! Best purchase ever.",
    "language": "en",

    "options": {
        "return_aspects": true,
        "return_entities": true,
        "detect_sarcasm": true
    }
}

Response (200 OK):
{
    "request_id": "req_text789",
    "text_length": 52,
    "language": "en",

    "sentiment": {
        "polarity": 0.92,
        "subjectivity": 0.85,
        "label": "very_positive"
    },

    "emotions": {
        "primary": { "label": "happiness", "confidence": 0.91 },
        "all": [
            { "label": "happiness", "confidence": 0.91 },
            { "label": "excitement", "confidence": 0.75 },
            { "label": "satisfaction", "confidence": 0.68 }
        ]
    },

    "dimensions": {
        "valence": 0.88,
        "arousal": 0.65
    },

    "aspects": [
        {
            "aspect": "product",
            "sentiment": 0.95,
            "mentions": ["product", "purchase"]
        }
    ],

    "entities": [
        {
            "text": "product",
            "type": "PRODUCT",
            "emotion": "happiness",
            "sentiment": 0.95
        }
    ],

    "sarcasm": {
        "detected": false,
        "confidence": 0.02
    }
}
</pre>

<h3>5.5.2 Batch Text Analysis</h3>

<pre>
POST /v1/analyze/text/batch

Request Body:
{
    "texts": [
        { "id": "review_1", "text": "Great product!" },
        { "id": "review_2", "text": "Terrible experience." },
        { "id": "review_3", "text": "It was okay, nothing special." }
    ],
    "language": "en"
}

Response (200 OK):
{
    "request_id": "req_batch001",
    "results": [
        {
            "id": "review_1",
            "sentiment": { "polarity": 0.85, "label": "positive" },
            "emotion": { "label": "happiness", "confidence": 0.82 }
        },
        {
            "id": "review_2",
            "sentiment": { "polarity": -0.78, "label": "negative" },
            "emotion": { "label": "anger", "confidence": 0.71 }
        },
        {
            "id": "review_3",
            "sentiment": { "polarity": 0.1, "label": "neutral" },
            "emotion": { "label": "neutral", "confidence": 0.85 }
        }
    ],
    "summary": {
        "average_sentiment": 0.06,
        "positive_count": 1,
        "negative_count": 1,
        "neutral_count": 1
    }
}
</pre>

<hr>

<h2>5.6 Biosignal Analysis API</h2>

<h3>5.6.1 Analyze Biosignals</h3>

<pre>
POST /v1/analyze/biosignal

Request Body:
{
    "signals": {
        "ecg": {
            "sample_rate": 256,
            "data": [0.12, 0.15, 0.18, ...],
            "unit": "mV"
        },
        "eda": {
            "sample_rate": 4,
            "data": [2.5, 2.6, 2.8, ...],
            "unit": "uS"
        }
    },
    "duration_ms": 60000,

    "options": {
        "return_hrv": true,
        "return_stress": true,
        "return_engagement": true
    }
}

Response (200 OK):
{
    "request_id": "req_bio001",
    "duration_ms": 60000,

    "heart_rate": {
        "mean_bpm": 72,
        "min_bpm": 65,
        "max_bpm": 82,
        "std_bpm": 5.2
    },

    "hrv": {
        "rmssd_ms": 42.5,
        "sdnn_ms": 55.3,
        "pnn50": 0.18,
        "lf_hf_ratio": 1.8
    },

    "eda": {
        "scl_mean": 3.2,
        "scr_count": 5,
        "scr_amplitude_mean": 0.8
    },

    "derived_states": {
        "stress_level": 0.35,
        "relaxation": 0.55,
        "engagement": 0.72,
        "arousal": 0.45
    },

    "timeline": [
        { "time_ms": 0, "stress": 0.3, "engagement": 0.7 },
        { "time_ms": 10000, "stress": 0.35, "engagement": 0.75 },
        { "time_ms": 20000, "stress": 0.4, "engagement": 0.68 }
    ]
}
</pre>

<hr>

<h2>5.7 Multimodal Fusion API</h2>

<h3>5.7.1 Multimodal Analysis</h3>

<pre>
POST /v1/analyze/multimodal

Request Body:
{
    "modalities": {
        "face": {
            "image_url": "https://example.com/face.jpg"
        },
        "voice": {
            "audio_url": "https://example.com/audio.wav"
        },
        "text": {
            "text": "I'm feeling great today!"
        }
    },

    "fusion": {
        "method": "weighted_average",
        "weights": {
            "face": 0.5,
            "voice": 0.3,
            "text": 0.2
        }
    }
}

Response (200 OK):
{
    "request_id": "req_multi001",

    "fused_result": {
        "emotions": {
            "primary": { "label": "happiness", "confidence": 0.88 }
        },
        "dimensions": {
            "valence": 0.75,
            "arousal": 0.52
        }
    },

    "modality_results": {
        "face": {
            "emotions": { "primary": { "label": "happiness", "confidence": 0.85 } },
            "dimensions": { "valence": 0.72, "arousal": 0.48 }
        },
        "voice": {
            "emotions": { "primary": { "label": "happiness", "confidence": 0.82 } },
            "dimensions": { "valence": 0.78, "arousal": 0.55 }
        },
        "text": {
            "emotions": { "primary": { "label": "happiness", "confidence": 0.90 } },
            "dimensions": { "valence": 0.80, "arousal": 0.60 }
        }
    },

    "fusion_details": {
        "method": "weighted_average",
        "weights_used": { "face": 0.5, "voice": 0.3, "text": 0.2 },
        "agreement_score": 0.92
    }
}
</pre>

<hr>

<h2>5.8 Error Handling</h2>

<h3>5.8.1 Error Response Format</h3>

<pre>
{
    "error": {
        "code": "INVALID_IMAGE",
        "message": "The provided image could not be processed",
        "details": {
            "reason": "No face detected in image",
            "suggestion": "Ensure the image contains a clearly visible face"
        }
    },
    "request_id": "req_err001"
}
</pre>

<h3>5.8.2 Error Codes</h3>

<table border="1" cellpadding="10">
    <thead>
        <tr>
            <th>HTTP Status</th>
            <th>Error Code</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>400</td>
            <td>INVALID_REQUEST</td>
            <td>Malformed request body</td>
        </tr>
        <tr>
            <td>400</td>
            <td>INVALID_IMAGE</td>
            <td>Image cannot be processed</td>
        </tr>
        <tr>
            <td>400</td>
            <td>NO_FACE_DETECTED</td>
            <td>No face found in image</td>
        </tr>
        <tr>
            <td>401</td>
            <td>UNAUTHORIZED</td>
            <td>Invalid or missing API key</td>
        </tr>
        <tr>
            <td>403</td>
            <td>FORBIDDEN</td>
            <td>Insufficient permissions</td>
        </tr>
        <tr>
            <td>429</td>
            <td>RATE_LIMITED</td>
            <td>Too many requests</td>
        </tr>
        <tr>
            <td>500</td>
            <td>INTERNAL_ERROR</td>
            <td>Server error</td>
        </tr>
    </tbody>
</table>

<hr>

<h2>5.9 Rate Limits</h2>

<table border="1" cellpadding="10">
    <thead>
        <tr>
            <th>Plan</th>
            <th>Requests/Minute</th>
            <th>Requests/Day</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Free</td>
            <td>10</td>
            <td>100</td>
        </tr>
        <tr>
            <td>Developer</td>
            <td>60</td>
            <td>10,000</td>
        </tr>
        <tr>
            <td>Business</td>
            <td>300</td>
            <td>100,000</td>
        </tr>
        <tr>
            <td>Enterprise</td>
            <td>Custom</td>
            <td>Custom</td>
        </tr>
    </tbody>
</table>

<hr>

<h2>5.10 Chapter Summary</h2>

<p>[OK] <strong>Key Takeaways:</strong></p>

<ol>
    <li><strong>RESTful Design:</strong> Standard HTTP methods, JSON format</li>
    <li><strong>Four Modality APIs:</strong> Face, Voice, Text, Biosignal</li>
    <li><strong>Multimodal Fusion:</strong> Combine modalities with configurable weights</li>
    <li><strong>Comprehensive Output:</strong> Emotions, dimensions, AUs, metadata</li>
    <li><strong>Error Handling:</strong> Clear error codes and messages</li>
    <li><strong>Rate Limiting:</strong> Tiered plans for different use cases</li>
</ol>

<hr>

<p><strong>Chapter 5 Complete</strong> | Approximate pages: 16</p>

<p><a href="chapter-06.html">Next: Chapter 6 - Phase 3: Streaming Protocol</a></p>

<hr>

<p><strong>WIA - World Certification Industry Association</strong></p>
<p>Hongik Ingan - Benefit All Humanity</p>
<p><a href="https://wiastandards.com">https://wiastandards.com</a></p>

</body>
</html>
