{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.family/schemas/eye-gaze/gaze-point.schema.json",
  "title": "WIA Eye Gaze Point Schema",
  "description": "Standard schema for eye gaze point data in WIA Eye Gaze Interoperability Protocol",
  "version": "1.0.0-draft",
  "type": "object",
  "required": ["timestamp", "x", "y", "confidence", "valid"],
  "properties": {
    "timestamp": {
      "type": "integer",
      "description": "Unix timestamp in milliseconds",
      "minimum": 0
    },
    "x": {
      "type": "number",
      "description": "Screen X coordinate (0.0 = left, 1.0 = right)",
      "minimum": -1,
      "maximum": 2
    },
    "y": {
      "type": "number",
      "description": "Screen Y coordinate (0.0 = top, 1.0 = bottom)",
      "minimum": -1,
      "maximum": 2
    },
    "confidence": {
      "type": "number",
      "description": "Data confidence level (0.0 - 1.0)",
      "minimum": 0,
      "maximum": 1
    },
    "valid": {
      "type": "boolean",
      "description": "Whether the data is valid"
    },
    "leftEye": {
      "$ref": "#/definitions/EyeData",
      "description": "Left eye specific data"
    },
    "rightEye": {
      "$ref": "#/definitions/EyeData",
      "description": "Right eye specific data"
    },
    "fixation": {
      "type": "boolean",
      "description": "Whether this point is part of a fixation"
    },
    "saccade": {
      "type": "boolean",
      "description": "Whether this point is part of a saccade"
    },
    "fixationId": {
      "type": "string",
      "description": "ID of the current fixation (if fixation is true)"
    },
    "deviceTimestamp": {
      "type": "integer",
      "description": "Device-specific timestamp",
      "minimum": 0
    },
    "invalidReason": {
      "type": "string",
      "enum": ["blink", "tracking_lost", "out_of_range", "calibration_required", "unknown"],
      "description": "Reason for invalid data"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "additionalProperties": true
    }
  },
  "definitions": {
    "Vector2D": {
      "type": "object",
      "required": ["x", "y"],
      "properties": {
        "x": {
          "type": "number",
          "description": "X coordinate"
        },
        "y": {
          "type": "number",
          "description": "Y coordinate"
        }
      }
    },
    "Vector3D": {
      "type": "object",
      "required": ["x", "y", "z"],
      "properties": {
        "x": {
          "type": "number",
          "description": "X coordinate (mm)"
        },
        "y": {
          "type": "number",
          "description": "Y coordinate (mm)"
        },
        "z": {
          "type": "number",
          "description": "Z coordinate (mm)"
        }
      }
    },
    "EyeData": {
      "type": "object",
      "required": ["gaze", "valid"],
      "properties": {
        "gaze": {
          "$ref": "#/definitions/Vector2D",
          "description": "Eye gaze position on screen (normalized)"
        },
        "valid": {
          "type": "boolean",
          "description": "Whether this eye's data is valid"
        },
        "pupilDiameter": {
          "type": "number",
          "description": "Pupil diameter in mm",
          "minimum": 0,
          "maximum": 10
        },
        "pupilCenter": {
          "$ref": "#/definitions/Vector2D",
          "description": "Pupil center in camera image (normalized)"
        },
        "gazeOrigin": {
          "$ref": "#/definitions/Vector3D",
          "description": "3D eye position relative to tracker (mm)"
        },
        "gazeDirection": {
          "$ref": "#/definitions/Vector3D",
          "description": "3D gaze direction unit vector"
        },
        "eyeOpenness": {
          "type": "number",
          "description": "Eye openness (0.0 = closed, 1.0 = fully open)",
          "minimum": 0,
          "maximum": 1
        },
        "eyeOpennessMm": {
          "type": "number",
          "description": "Eye openness in mm",
          "minimum": 0
        }
      }
    }
  },
  "examples": [
    {
      "timestamp": 1704067200000,
      "x": 0.5234,
      "y": 0.3891,
      "confidence": 0.95,
      "valid": true,
      "leftEye": {
        "gaze": { "x": 0.5198, "y": 0.3876 },
        "valid": true,
        "pupilDiameter": 4.2,
        "eyeOpenness": 0.92
      },
      "rightEye": {
        "gaze": { "x": 0.5270, "y": 0.3906 },
        "valid": true,
        "pupilDiameter": 4.1,
        "eyeOpenness": 0.91
      },
      "fixation": true,
      "fixationId": "fix_001"
    }
  ]
}
