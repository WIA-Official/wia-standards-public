{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/schemas/physics/time-crystal.schema.json",
  "title": "WIA Physics Time Crystal Schema",
  "description": "Schema for time crystal data in WIA Physics Standard",
  "version": "1.0.0",
  "type": "object",

  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://wia.live/schemas/physics/time-crystal.schema.json"
    },
    "metadata": {
      "$ref": "common.schema.json#/$defs/metadata"
    },
    "time_crystal": {
      "$ref": "#/$defs/time_crystal_parameters"
    },
    "material_system": {
      "$ref": "#/$defs/material_system"
    },
    "quantum_properties": {
      "$ref": "#/$defs/quantum_properties"
    },
    "driving_parameters": {
      "$ref": "#/$defs/driving_parameters"
    },
    "measurements": {
      "type": "array",
      "items": {"$ref": "#/$defs/measurement_record"}
    },
    "quality": {
      "$ref": "common.schema.json#/$defs/quality_flag"
    },
    "provenance": {
      "$ref": "common.schema.json#/$defs/provenance"
    }
  },

  "required": ["metadata", "time_crystal"],

  "$defs": {
    "time_crystal_parameters": {
      "type": "object",
      "description": "Core time crystal parameters",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["discrete", "continuous", "floquet", "prethermal", "dissipative"],
          "description": "Time crystal type"
        },
        "oscillation_period": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Period of spontaneous oscillation"
        },
        "oscillation_frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Frequency of spontaneous oscillation"
        },
        "driving_frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "External driving frequency (if driven)"
        },
        "period_ratio": {
          "type": "number",
          "description": "Ratio of response period to driving period"
        },
        "subharmonic_order": {
          "type": "integer",
          "minimum": 2,
          "description": "Subharmonic order (2 for period doubling, etc.)"
        },
        "coherence_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Time before decoherence"
        },
        "coherence_cycles": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of coherent oscillation cycles"
        },
        "lifetime": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Total time crystal lifetime"
        },
        "phase_coherence": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Phase coherence measure (0-1)"
        }
      },
      "required": ["type", "oscillation_period", "coherence_time"]
    },

    "material_system": {
      "type": "object",
      "description": "Physical system hosting the time crystal",
      "properties": {
        "material": {
          "type": "string",
          "description": "Material composition"
        },
        "system_type": {
          "type": "string",
          "enum": ["magnon", "spin_chain", "trapped_ion", "superconducting_qubit", "liquid_crystal", "bec", "photonic", "phononic", "nitrogen_vacancy"],
          "description": "Physical system type"
        },
        "temperature": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Operating temperature"
        },
        "particle_count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of particles/sites in system"
        },
        "dimensions": {
          "type": "array",
          "items": {"type": "integer"},
          "description": "System dimensions (1D, 2D, 3D)"
        },
        "lattice_spacing": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Lattice constant (if applicable)"
        },
        "magnetic_field": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Applied magnetic field"
        },
        "pressure": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Operating pressure"
        }
      },
      "required": ["system_type", "temperature"]
    },

    "quantum_properties": {
      "type": "object",
      "description": "Quantum mechanical properties",
      "properties": {
        "entanglement_type": {
          "type": "string",
          "enum": ["GHZ", "W", "cluster", "graph", "none"],
          "description": "Type of entanglement"
        },
        "qubit_count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of qubits (if applicable)"
        },
        "fidelity": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "State fidelity (0-1)"
        },
        "purity": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "State purity"
        },
        "error_rate": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Error rate per cycle"
        },
        "t1_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Energy relaxation time"
        },
        "t2_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Dephasing time"
        },
        "entanglement_entropy": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Entanglement entropy"
        }
      }
    },

    "driving_parameters": {
      "type": "object",
      "description": "External driving parameters",
      "properties": {
        "drive_type": {
          "type": "string",
          "enum": ["microwave", "laser", "magnetic_pulse", "electric_pulse", "acoustic", "ambient_light", "none"],
          "description": "Type of external drive"
        },
        "frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Drive frequency"
        },
        "amplitude": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Drive amplitude"
        },
        "pulse_duration": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Pulse duration (if pulsed)"
        },
        "duty_cycle": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Duty cycle for pulsed drive"
        },
        "wavelength": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Light wavelength (if optical)"
        },
        "power": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Drive power"
        }
      }
    },

    "measurement_record": {
      "type": "object",
      "description": "Individual measurement record",
      "properties": {
        "observable": {
          "type": "string",
          "description": "Measured observable"
        },
        "value": {
          "$ref": "common.schema.json#/$defs/measurement"
        },
        "time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Time of measurement"
        },
        "cycle_number": {
          "type": "integer",
          "description": "Oscillation cycle number"
        },
        "phase": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Phase in oscillation cycle"
        }
      },
      "required": ["observable", "value"]
    }
  }
}
