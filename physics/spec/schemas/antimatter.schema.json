{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/schemas/physics/antimatter.schema.json",
  "title": "WIA Physics Antimatter Schema",
  "description": "Schema for antimatter research data in WIA Physics Standard",
  "version": "1.0.0",
  "type": "object",

  "properties": {
    "$schema": {
      "type": "string",
      "const": "https://wia.live/schemas/physics/antimatter.schema.json"
    },
    "metadata": {
      "$ref": "common.schema.json#/$defs/metadata"
    },
    "antiparticle": {
      "$ref": "#/$defs/antiparticle_properties"
    },
    "trap": {
      "$ref": "#/$defs/trap_parameters"
    },
    "spectroscopy": {
      "$ref": "#/$defs/spectroscopic_measurement"
    },
    "production": {
      "$ref": "#/$defs/production_data"
    },
    "cpt_test": {
      "$ref": "#/$defs/cpt_test_result"
    },
    "gravity_measurement": {
      "$ref": "#/$defs/gravity_measurement"
    },
    "quality": {
      "$ref": "common.schema.json#/$defs/quality_flag"
    },
    "provenance": {
      "$ref": "common.schema.json#/$defs/provenance"
    }
  },

  "required": ["metadata"],

  "$defs": {
    "antiparticle_properties": {
      "type": "object",
      "description": "Antiparticle properties and state",
      "properties": {
        "particle_type": {
          "type": "string",
          "enum": ["antiproton", "positron", "antihydrogen", "antideuteron", "antihelium3", "antihelium4", "other"],
          "description": "Type of antiparticle"
        },
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of particles"
        },
        "temperature": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Particle temperature"
        },
        "kinetic_energy": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Kinetic energy"
        },
        "quantum_state": {
          "type": "string",
          "description": "Quantum state label"
        },
        "spin_state": {
          "type": "string",
          "enum": ["up", "down", "superposition", "mixed"],
          "description": "Spin polarization state"
        },
        "polarization": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Degree of spin polarization"
        },
        "storage_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Time in storage"
        },
        "formation_time": {
          "type": "string",
          "format": "date-time",
          "description": "Time of formation/trapping"
        }
      },
      "required": ["particle_type", "count"]
    },

    "trap_parameters": {
      "type": "object",
      "description": "Particle trap parameters",
      "properties": {
        "trap_type": {
          "type": "string",
          "enum": ["penning", "paul", "magnetic_minimum", "ioffe", "combined", "optical"],
          "description": "Type of trap"
        },
        "trap_name": {
          "type": "string",
          "description": "Specific trap identifier"
        },
        "magnetic_field": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Magnetic field strength"
        },
        "electric_field": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Electric field strength"
        },
        "trap_depth": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Trap depth (K or eV)"
        },
        "trap_frequency_axial": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Axial oscillation frequency"
        },
        "trap_frequency_radial": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Radial oscillation frequency"
        },
        "cyclotron_frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Cyclotron frequency"
        },
        "magnetron_frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Magnetron frequency"
        },
        "vacuum_pressure": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Residual gas pressure"
        },
        "base_temperature": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Trap base temperature"
        },
        "storage_lifetime": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Characteristic storage time"
        },
        "portable": {
          "type": "boolean",
          "description": "Portable trap system"
        }
      },
      "required": ["trap_type"]
    },

    "spectroscopic_measurement": {
      "type": "object",
      "description": "Spectroscopic measurement data",
      "properties": {
        "transition": {
          "type": "string",
          "description": "Transition identifier (e.g., 1S-2S, 1S-2P)"
        },
        "frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Measured transition frequency"
        },
        "wavelength": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Transition wavelength"
        },
        "linewidth": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Observed linewidth"
        },
        "natural_linewidth": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Natural linewidth"
        },
        "hydrogen_comparison": {
          "type": "object",
          "properties": {
            "hydrogen_frequency": {"$ref": "common.schema.json#/$defs/measurement"},
            "frequency_difference": {"$ref": "common.schema.json#/$defs/measurement"},
            "relative_difference": {"$ref": "common.schema.json#/$defs/measurement"}
          },
          "description": "Comparison with hydrogen"
        },
        "laser_parameters": {
          "type": "object",
          "properties": {
            "wavelength": {"$ref": "common.schema.json#/$defs/measurement"},
            "power": {"$ref": "common.schema.json#/$defs/measurement"},
            "linewidth": {"$ref": "common.schema.json#/$defs/measurement"},
            "stabilization": {"type": "string"}
          }
        },
        "signal_count": {
          "type": "integer",
          "description": "Number of detected events"
        },
        "background_count": {
          "type": "integer",
          "description": "Background events"
        }
      },
      "required": ["transition", "frequency"]
    },

    "production_data": {
      "type": "object",
      "description": "Antiparticle production data",
      "properties": {
        "method": {
          "type": "string",
          "enum": ["AD_deceleration", "ELENA_deceleration", "pair_production", "charge_exchange", "three_body_recombination", "radiative_recombination", "laser_stimulated"],
          "description": "Production method"
        },
        "production_rate": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Production rate (particles/s)"
        },
        "total_produced": {
          "type": "integer",
          "description": "Total particles produced"
        },
        "trapping_efficiency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Fraction successfully trapped"
        },
        "total_trapped": {
          "type": "integer",
          "description": "Total particles trapped"
        },
        "cooling_method": {
          "type": "string",
          "enum": ["sympathetic", "laser", "resistive", "evaporative", "adiabatic"],
          "description": "Cooling method used"
        },
        "final_temperature": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Temperature after cooling"
        },
        "cooling_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Cooling duration"
        },
        "annihilation_rate": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Background annihilation rate"
        },
        "run_duration": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Duration of production run"
        }
      },
      "required": ["method"]
    },

    "cpt_test_result": {
      "type": "object",
      "description": "CPT symmetry test result",
      "properties": {
        "test_type": {
          "type": "string",
          "enum": ["charge_to_mass", "magnetic_moment", "spectroscopy", "lifetime", "gravitational"],
          "description": "Type of CPT test"
        },
        "quantity_measured": {
          "type": "string",
          "description": "Physical quantity being compared"
        },
        "matter_value": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Value for matter"
        },
        "antimatter_value": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Value for antimatter"
        },
        "relative_difference": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Relative difference |Î”|/avg"
        },
        "cpt_violation_limit": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Upper limit on CPT violation"
        },
        "confidence_level": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence level"
        },
        "consistent_with_cpt": {
          "type": "boolean",
          "description": "Result consistent with CPT symmetry"
        }
      },
      "required": ["test_type", "antimatter_value"]
    },

    "gravity_measurement": {
      "type": "object",
      "description": "Antimatter gravity measurement",
      "properties": {
        "experiment": {
          "type": "string",
          "enum": ["ALPHA-g", "AEgIS", "GBAR", "other"],
          "description": "Experiment name"
        },
        "antiparticle": {
          "type": "string",
          "description": "Antiparticle used"
        },
        "g_measured": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Measured gravitational acceleration"
        },
        "g_ratio": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Ratio g_antimatter / g_matter"
        },
        "wep_violation_limit": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Limit on WEP violation"
        },
        "free_fall_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Free-fall observation time"
        },
        "drop_height": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Free-fall height"
        },
        "consistent_with_grav": {
          "type": "boolean",
          "description": "Consistent with normal gravity"
        }
      },
      "required": ["experiment"]
    },

    "qubit_state": {
      "type": "object",
      "description": "Antimatter qubit state",
      "properties": {
        "qubit_type": {
          "type": "string",
          "enum": ["spin", "cyclotron", "axial"],
          "description": "Qubit degree of freedom"
        },
        "coherence_time": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Quantum coherence time"
        },
        "spin_flip_probability": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Single spin flip probability"
        },
        "rabi_frequency": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "Rabi oscillation frequency"
        },
        "fidelity": {
          "$ref": "common.schema.json#/$defs/measurement",
          "description": "State preparation fidelity"
        }
      }
    }
  }
}
