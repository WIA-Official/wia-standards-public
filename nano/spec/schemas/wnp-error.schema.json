{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/nano/wnp-error.schema.json",
  "title": "WIA Nano Protocol Error",
  "description": "Schema for WIA Nano Protocol (WNP) error messages",
  "type": "object",
  "required": ["error_code", "error_category", "error_message"],
  "properties": {
    "error_code": {
      "type": "integer",
      "minimum": 1000,
      "maximum": 5999,
      "description": "Numeric error code"
    },
    "error_category": {
      "type": "string",
      "enum": ["diffusion", "molecular", "network", "bio_interface", "system"],
      "description": "Error category"
    },
    "error_message": {
      "type": "string",
      "minLength": 1,
      "description": "Human-readable error message"
    },
    "details": {
      "type": "object",
      "description": "Additional error details"
    },
    "recoverable": {
      "type": "boolean",
      "default": false,
      "description": "Whether the error is recoverable"
    },
    "suggested_action": {
      "type": "string",
      "description": "Suggested recovery action"
    },
    "source_message_id": {
      "type": "string",
      "format": "uuid",
      "description": "ID of the message that caused the error"
    },
    "timestamp": {
      "type": "integer",
      "minimum": 0,
      "description": "Error timestamp in milliseconds"
    }
  },
  "definitions": {
    "errorCodes": {
      "description": "Standard error codes by category",
      "type": "object",
      "properties": {
        "diffusion": {
          "description": "Diffusion/transport errors (1000-1999)",
          "type": "object",
          "properties": {
            "SIGNAL_ATTENUATED": { "const": 1001 },
            "DIFFUSION_TIMEOUT": { "const": 1002 },
            "MEDIUM_INCOMPATIBLE": { "const": 1003 },
            "TEMPERATURE_OUT_OF_RANGE": { "const": 1004 },
            "CARRIER_DEGRADED": { "const": 1005 },
            "FLOW_DISRUPTION": { "const": 1006 },
            "VISCOSITY_TOO_HIGH": { "const": 1007 },
            "BROWNIAN_NOISE_EXCESSIVE": { "const": 1008 }
          }
        },
        "molecular": {
          "description": "Molecular signaling errors (2000-2999)",
          "type": "object",
          "properties": {
            "MOLECULE_DEGRADED": { "const": 2001 },
            "RECEPTOR_SATURATED": { "const": 2002 },
            "WRONG_MOLECULE_TYPE": { "const": 2003 },
            "CONCENTRATION_TOO_LOW": { "const": 2004 },
            "CONCENTRATION_TOO_HIGH": { "const": 2005 },
            "QUORUM_NOT_REACHED": { "const": 2006 },
            "DNA_STRAND_MISMATCH": { "const": 2007 },
            "LOGIC_GATE_FAILURE": { "const": 2008 },
            "ENZYME_INACTIVE": { "const": 2009 }
          }
        },
        "network": {
          "description": "Network/routing errors (3000-3999)",
          "type": "object",
          "properties": {
            "NODE_UNREACHABLE": { "const": 3001 },
            "SWARM_DISCONNECTED": { "const": 3002 },
            "ROUTE_NOT_FOUND": { "const": 3003 },
            "TTL_EXPIRED": { "const": 3004 },
            "BROADCAST_FAILED": { "const": 3005 },
            "LEADER_UNAVAILABLE": { "const": 3006 },
            "CONSENSUS_FAILED": { "const": 3007 },
            "FORMATION_BROKEN": { "const": 3008 },
            "GATEWAY_UNREACHABLE": { "const": 3009 }
          }
        },
        "bio_interface": {
          "description": "Bio-nano interface errors (4000-4999)",
          "type": "object",
          "properties": {
            "CELL_MEMBRANE_BLOCKED": { "const": 4001 },
            "IMMUNE_RESPONSE": { "const": 4002 },
            "RECEPTOR_NOT_FOUND": { "const": 4003 },
            "ENDOCYTOSIS_FAILED": { "const": 4004 },
            "CARGO_RELEASE_FAILED": { "const": 4005 },
            "CELL_DEATH_DETECTED": { "const": 4006 },
            "BIOCOMPATIBILITY_ISSUE": { "const": 4007 },
            "WRONG_CELL_TYPE": { "const": 4008 },
            "LIGAND_BINDING_FAILED": { "const": 4009 }
          }
        },
        "system": {
          "description": "System/device errors (5000-5999)",
          "type": "object",
          "properties": {
            "ENERGY_DEPLETED": { "const": 5001 },
            "COMPONENT_FAILURE": { "const": 5002 },
            "SENSOR_MALFUNCTION": { "const": 5003 },
            "MOTOR_FAILURE": { "const": 5004 },
            "MEMORY_OVERFLOW": { "const": 5005 },
            "CONFIGURATION_INVALID": { "const": 5006 },
            "COMMAND_NOT_SUPPORTED": { "const": 5007 },
            "TIMEOUT": { "const": 5008 },
            "CHECKSUM_MISMATCH": { "const": 5009 }
          }
        }
      }
    }
  },
  "examples": [
    {
      "error_code": 1001,
      "error_category": "diffusion",
      "error_message": "Signal attenuation exceeded threshold",
      "details": {
        "expected_concentration_nm": 50,
        "actual_concentration_nm": 5,
        "distance_nm": 5000
      },
      "recoverable": true,
      "suggested_action": "increase_signal_strength"
    },
    {
      "error_code": 2006,
      "error_category": "molecular",
      "error_message": "Quorum sensing threshold not reached",
      "details": {
        "current_concentration_nm": 45,
        "threshold_nm": 100,
        "participating_nodes": 12
      },
      "recoverable": true,
      "suggested_action": "wait_for_more_nodes"
    },
    {
      "error_code": 4002,
      "error_category": "bio_interface",
      "error_message": "Immune system response detected",
      "details": {
        "response_type": "macrophage_phagocytosis",
        "location_nm": {"x": 1500, "y": 2000, "z": 800}
      },
      "recoverable": false,
      "suggested_action": "abort_mission"
    }
  ]
}
