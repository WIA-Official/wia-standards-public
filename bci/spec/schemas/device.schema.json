{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/bci/device.schema.json",
  "title": "WIA BCI Device",
  "description": "Schema for BCI device information",
  "type": "object",
  "required": [
    "device_id",
    "device_type",
    "acquisition"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "device_id": {
      "type": "string",
      "pattern": "^dev-[a-zA-Z0-9-]+$",
      "description": "Unique device identifier"
    },
    "device_info": {
      "type": "object",
      "properties": {
        "manufacturer": {
          "type": "string",
          "description": "Device manufacturer name"
        },
        "model": {
          "type": "string",
          "description": "Device model name"
        },
        "serial_number": {
          "type": "string",
          "description": "Device serial number"
        },
        "firmware_version": {
          "type": "string",
          "description": "Device firmware version"
        }
      }
    },
    "device_type": {
      "type": "string",
      "enum": [
        "eeg",
        "eeg_cap",
        "implant_cortical",
        "implant_endovascular",
        "implant_epidural",
        "fnirs",
        "meg",
        "ecog",
        "hybrid"
      ],
      "description": "Type of BCI device"
    },
    "invasiveness": {
      "type": "string",
      "enum": [
        "non_invasive",
        "minimally_invasive",
        "invasive"
      ],
      "description": "Level of invasiveness"
    },
    "acquisition": {
      "type": "object",
      "required": ["sampling_rate_hz"],
      "properties": {
        "sampling_rate_hz": {
          "type": "number",
          "minimum": 1,
          "maximum": 100000,
          "description": "Data sampling rate in Hz"
        },
        "resolution_bits": {
          "type": "integer",
          "minimum": 8,
          "maximum": 32,
          "description": "ADC resolution in bits"
        },
        "gain": {
          "type": "number",
          "minimum": 1,
          "description": "Amplifier gain"
        },
        "reference_type": {
          "type": "string",
          "enum": [
            "common_average",
            "linked_mastoids",
            "linked_ears",
            "single_electrode",
            "bipolar",
            "laplacian",
            "none"
          ],
          "description": "Reference electrode configuration"
        },
        "ground_electrode": {
          "type": "string",
          "description": "Ground electrode location"
        },
        "input_range_mv": {
          "type": "number",
          "description": "Input voltage range in millivolts"
        },
        "noise_level_uvrms": {
          "type": "number",
          "description": "RMS noise level in microvolts"
        }
      }
    },
    "communication": {
      "type": "object",
      "properties": {
        "protocol": {
          "type": "string",
          "enum": [
            "usb",
            "bluetooth_classic",
            "bluetooth_le",
            "wifi",
            "ethernet",
            "serial",
            "proprietary"
          ],
          "description": "Communication protocol"
        },
        "data_format": {
          "type": "string",
          "description": "Native data format identifier"
        },
        "packet_size_bytes": {
          "type": "integer",
          "description": "Data packet size in bytes"
        },
        "packet_rate_hz": {
          "type": "number",
          "description": "Packet transmission rate"
        }
      }
    },
    "electrodes": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "wet",
            "dry",
            "semi_dry",
            "needle",
            "microelectrode_array",
            "stentrode"
          ],
          "description": "Electrode type"
        },
        "material": {
          "type": "string",
          "enum": [
            "ag_agcl",
            "gold",
            "platinum",
            "stainless_steel",
            "carbon",
            "conductive_polymer",
            "iridium_oxide"
          ],
          "description": "Electrode material"
        },
        "placement_system": {
          "type": "string",
          "enum": ["10-20", "10-10", "10-5", "custom"],
          "description": "Electrode placement standard"
        },
        "total_channels": {
          "type": "integer",
          "minimum": 1,
          "description": "Total number of recording channels"
        },
        "electrode_diameter_mm": {
          "type": "number",
          "description": "Electrode contact diameter"
        },
        "inter_electrode_distance_mm": {
          "type": "number",
          "description": "Distance between electrode centers"
        }
      }
    },
    "calibration": {
      "type": "object",
      "properties": {
        "last_calibration": {
          "type": "string",
          "format": "date-time",
          "description": "Last calibration timestamp"
        },
        "scale_factor_uv_per_count": {
          "type": "number",
          "description": "Scale factor to convert ADC counts to microvolts"
        },
        "offset_uv": {
          "type": "number",
          "description": "DC offset in microvolts"
        },
        "calibration_method": {
          "type": "string",
          "description": "Calibration method used"
        }
      }
    },
    "power": {
      "type": "object",
      "properties": {
        "source": {
          "type": "string",
          "enum": [
            "battery",
            "usb",
            "wall_power",
            "wireless_charging",
            "inductive",
            "ultrasonic"
          ]
        },
        "battery_capacity_mah": {
          "type": "number"
        },
        "runtime_hours": {
          "type": "number"
        }
      }
    },
    "regulatory": {
      "type": "object",
      "properties": {
        "fda_status": {
          "type": "string",
          "enum": [
            "cleared_510k",
            "approved_pma",
            "breakthrough_device",
            "investigational",
            "exempt",
            "not_applicable"
          ]
        },
        "ce_marking": {
          "type": "boolean"
        },
        "medical_device_class": {
          "type": "string",
          "enum": ["I", "IIa", "IIb", "III"]
        }
      }
    }
  }
}
