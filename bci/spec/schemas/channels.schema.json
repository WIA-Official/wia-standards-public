{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/bci/channels.schema.json",
  "title": "WIA BCI Channels",
  "description": "Schema for channel definitions",
  "type": "object",
  "required": [
    "channel_count",
    "channels"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "channel_count": {
      "type": "integer",
      "minimum": 1,
      "description": "Total number of data channels"
    },
    "sampling_rate_hz": {
      "type": "number",
      "minimum": 1,
      "description": "Sampling rate in Hz (if same for all channels)"
    },
    "channels": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/channel"
      },
      "description": "Array of channel definitions"
    },
    "reference_channels": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/referenceChannel"
      },
      "description": "Reference and ground electrode definitions"
    },
    "channel_groups": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "channel_indices": {
            "type": "array",
            "items": {
              "type": "integer"
            }
          },
          "description": {
            "type": "string"
          }
        }
      },
      "description": "Logical groupings of channels"
    }
  },
  "definitions": {
    "channel": {
      "type": "object",
      "required": ["index", "label", "type"],
      "properties": {
        "index": {
          "type": "integer",
          "minimum": 0,
          "description": "Zero-based channel index"
        },
        "label": {
          "type": "string",
          "description": "Channel label (e.g., Fp1, C3)"
        },
        "type": {
          "type": "string",
          "enum": [
            "eeg",
            "emg",
            "eog",
            "ecg",
            "trigger",
            "accel",
            "gyro",
            "aux",
            "stim",
            "lfp"
          ],
          "description": "Channel type"
        },
        "unit": {
          "type": "string",
          "enum": ["uV", "mV", "V", "count", "g", "deg_s", "boolean"],
          "default": "uV",
          "description": "Physical unit"
        },
        "sampling_rate_hz": {
          "type": "number",
          "description": "Channel-specific sampling rate (if different)"
        },
        "position": {
          "$ref": "#/definitions/position"
        },
        "reference": {
          "type": "string",
          "description": "Reference electrode for this channel"
        },
        "filters": {
          "$ref": "#/definitions/filters"
        },
        "impedance_kohm": {
          "type": "number",
          "minimum": 0,
          "description": "Electrode impedance in kOhm"
        },
        "status": {
          "type": "string",
          "enum": ["good", "bad", "interpolated", "bridged", "excluded"],
          "description": "Channel quality status"
        },
        "description": {
          "type": "string",
          "description": "Additional channel description"
        }
      }
    },
    "referenceChannel": {
      "type": "object",
      "required": ["label", "type"],
      "properties": {
        "label": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": ["reference", "ground", "driven_right_leg"]
        },
        "position": {
          "$ref": "#/definitions/position"
        }
      }
    },
    "position": {
      "type": "object",
      "properties": {
        "system": {
          "type": "string",
          "enum": ["10-20", "10-10", "10-5", "custom", "mni", "talairach"],
          "description": "Coordinate system"
        },
        "location": {
          "type": "string",
          "description": "Anatomical location name"
        },
        "x": {
          "type": "number",
          "description": "X coordinate (normalized or mm)"
        },
        "y": {
          "type": "number",
          "description": "Y coordinate (normalized or mm)"
        },
        "z": {
          "type": "number",
          "description": "Z coordinate (normalized or mm)"
        },
        "theta": {
          "type": "number",
          "description": "Theta angle in spherical coordinates (degrees)"
        },
        "phi": {
          "type": "number",
          "description": "Phi angle in spherical coordinates (degrees)"
        }
      }
    },
    "filters": {
      "type": "object",
      "properties": {
        "highpass_hz": {
          "type": "number",
          "minimum": 0,
          "description": "High-pass filter cutoff frequency"
        },
        "lowpass_hz": {
          "type": "number",
          "minimum": 0,
          "description": "Low-pass filter cutoff frequency"
        },
        "notch_hz": {
          "oneOf": [
            {"type": "number"},
            {"type": "array", "items": {"type": "number"}}
          ],
          "description": "Notch filter frequency/frequencies"
        },
        "filter_order": {
          "type": "integer",
          "description": "Filter order"
        },
        "filter_type": {
          "type": "string",
          "enum": ["butterworth", "chebyshev", "bessel", "fir", "iir"],
          "description": "Filter type"
        }
      }
    }
  }
}
