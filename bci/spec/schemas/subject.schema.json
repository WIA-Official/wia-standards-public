{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/bci/subject.schema.json",
  "title": "WIA BCI Subject",
  "description": "Schema for subject/participant information",
  "type": "object",
  "required": [
    "subject_id"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "subject_id": {
      "type": "string",
      "pattern": "^sub-[a-zA-Z0-9]+$",
      "description": "Anonymized subject identifier"
    },
    "demographics": {
      "type": "object",
      "properties": {
        "age_years": {
          "type": "integer",
          "minimum": 0,
          "maximum": 150,
          "description": "Age in years"
        },
        "age_range": {
          "type": "string",
          "enum": [
            "0-17",
            "18-29",
            "30-39",
            "40-49",
            "50-59",
            "60-69",
            "70-79",
            "80+"
          ],
          "description": "Age range for anonymization"
        },
        "sex": {
          "type": "string",
          "enum": ["male", "female", "other", "unknown"],
          "description": "Biological sex"
        },
        "handedness": {
          "type": "string",
          "enum": ["right", "left", "ambidextrous", "unknown"],
          "description": "Dominant hand"
        },
        "language": {
          "type": "string",
          "pattern": "^[a-z]{2}(-[A-Z]{2})?$",
          "description": "Primary language (ISO 639-1)"
        },
        "education_years": {
          "type": "integer",
          "minimum": 0,
          "description": "Years of formal education"
        }
      }
    },
    "condition": {
      "type": "object",
      "properties": {
        "diagnosis": {
          "type": "string",
          "enum": [
            "healthy",
            "spinal_cord_injury",
            "als",
            "stroke",
            "locked_in_syndrome",
            "muscular_dystrophy",
            "cerebral_palsy",
            "parkinsons",
            "epilepsy",
            "traumatic_brain_injury",
            "multiple_sclerosis",
            "blindness",
            "deafness",
            "other"
          ],
          "description": "Primary diagnosis"
        },
        "diagnosis_code_icd10": {
          "type": "string",
          "pattern": "^[A-Z][0-9]{2}(\\.[0-9]{1,2})?$",
          "description": "ICD-10 diagnosis code"
        },
        "level": {
          "type": "string",
          "description": "Injury/lesion level (e.g., C4 for SCI)"
        },
        "completeness": {
          "type": "string",
          "enum": ["complete", "incomplete", "unknown"],
          "description": "Injury completeness"
        },
        "years_since_onset": {
          "type": "number",
          "minimum": 0,
          "description": "Years since condition onset"
        },
        "medications": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Current medications that may affect neural signals"
        },
        "comorbidities": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Other relevant conditions"
        }
      }
    },
    "bci_experience": {
      "type": "object",
      "properties": {
        "previous_bci_use": {
          "type": "boolean",
          "description": "Has used BCI before"
        },
        "training_sessions": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of BCI training sessions"
        },
        "total_hours": {
          "type": "number",
          "minimum": 0,
          "description": "Total hours of BCI use"
        },
        "proficiency_level": {
          "type": "string",
          "enum": [
            "novice",
            "beginner",
            "intermediate",
            "advanced",
            "expert"
          ],
          "description": "BCI proficiency level"
        },
        "preferred_paradigm": {
          "type": "string",
          "description": "Preferred BCI paradigm"
        }
      }
    },
    "implant_info": {
      "type": "object",
      "description": "For subjects with implanted BCIs",
      "properties": {
        "has_implant": {
          "type": "boolean"
        },
        "implant_date": {
          "type": "string",
          "format": "date"
        },
        "implant_location": {
          "type": "string",
          "enum": [
            "motor_cortex_left",
            "motor_cortex_right",
            "motor_cortex_bilateral",
            "sensory_cortex",
            "visual_cortex",
            "auditory_cortex",
            "hippocampus",
            "other"
          ]
        },
        "implant_type": {
          "type": "string"
        },
        "surgeon": {
          "type": "string"
        },
        "institution": {
          "type": "string"
        }
      }
    },
    "consent": {
      "type": "object",
      "properties": {
        "informed_consent": {
          "type": "boolean",
          "description": "Informed consent obtained"
        },
        "consent_date": {
          "type": "string",
          "format": "date",
          "description": "Date consent was obtained"
        },
        "consent_version": {
          "type": "string",
          "description": "Version of consent form"
        },
        "data_sharing": {
          "type": "string",
          "enum": [
            "full",
            "anonymized",
            "research_only",
            "none"
          ],
          "description": "Data sharing permission level"
        },
        "ethics_approval": {
          "type": "string",
          "description": "IRB/Ethics approval number"
        },
        "ethics_institution": {
          "type": "string",
          "description": "Ethics review institution"
        }
      }
    }
  }
}
