{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-standards.org/myoelectric/model-metadata.schema.json",
  "title": "WIA Model Metadata",
  "description": "Metadata for WIA pretrained gesture recognition models",
  "type": "object",
  "required": ["model_id", "version", "model_type", "gestures", "input_spec", "output_spec"],
  "properties": {
    "model_id": {
      "type": "string",
      "pattern": "^wia_[a-z]+_[0-9]+gesture$",
      "description": "Unique model identifier",
      "examples": ["wia_transformer_5gesture"]
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "Semantic version",
      "examples": ["1.0.0"]
    },
    "model_type": {
      "type": "string",
      "enum": ["lda", "svm", "knn", "cnn", "lstm", "transformer"],
      "description": "Type of classifier model"
    },
    "framework": {
      "type": "string",
      "enum": ["onnx", "pytorch", "tensorflow", "sklearn"],
      "description": "Original training framework"
    },
    "gestures": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["index", "name", "description"],
        "properties": {
          "index": {
            "type": "integer",
            "minimum": 0
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        }
      },
      "minItems": 2,
      "description": "List of gesture classes"
    },
    "input_spec": {
      "type": "object",
      "required": ["type", "shape"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["feature_vector", "raw_signal", "sequence"],
          "description": "Type of input data"
        },
        "shape": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "description": "Expected input tensor shape (excluding batch)"
        },
        "dtype": {
          "type": "string",
          "enum": ["float32", "float64", "int32"],
          "default": "float32"
        },
        "normalization": {
          "type": "object",
          "properties": {
            "method": {
              "type": "string",
              "enum": ["none", "minmax", "zscore", "per_channel_zscore"]
            },
            "params": {
              "type": "object"
            }
          }
        },
        "sample_rate": {
          "type": "integer",
          "description": "Expected sample rate in Hz",
          "examples": [1000]
        },
        "window_ms": {
          "type": "integer",
          "description": "Window size in milliseconds"
        },
        "channels": {
          "type": "integer",
          "minimum": 1,
          "maximum": 16,
          "description": "Number of EMG channels"
        }
      }
    },
    "output_spec": {
      "type": "object",
      "required": ["type", "num_classes"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["logits", "probabilities", "class_index"],
          "description": "Output type"
        },
        "num_classes": {
          "type": "integer",
          "minimum": 2
        },
        "activation": {
          "type": "string",
          "enum": ["none", "softmax", "sigmoid"]
        }
      }
    },
    "training_info": {
      "type": "object",
      "properties": {
        "dataset": {
          "type": "string",
          "description": "Training dataset name"
        },
        "num_subjects": {
          "type": "integer"
        },
        "num_samples": {
          "type": "integer"
        },
        "accuracy": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "date": {
          "type": "string",
          "format": "date"
        }
      }
    },
    "performance": {
      "type": "object",
      "properties": {
        "latency_ms": {
          "type": "object",
          "properties": {
            "cpu": {
              "type": "number"
            },
            "gpu": {
              "type": "number"
            }
          }
        },
        "model_size_bytes": {
          "type": "integer"
        },
        "flops": {
          "type": "integer",
          "description": "Floating point operations per inference"
        }
      }
    },
    "requirements": {
      "type": "object",
      "properties": {
        "min_ram_mb": {
          "type": "integer"
        },
        "onnx_runtime_version": {
          "type": "string"
        },
        "cuda_required": {
          "type": "boolean",
          "default": false
        }
      }
    }
  }
}
