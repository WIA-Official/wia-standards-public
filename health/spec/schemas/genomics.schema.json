{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/health/schemas/genomics.schema.json",
  "title": "WIA Health Genomic Profile",
  "description": "Genomic data including sequencing, variants, and pharmacogenomics",
  "type": "object",
  "properties": {
    "sequencing": {
      "type": "object",
      "description": "Sequencing information",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["WGS", "WES", "TargetedPanel", "SNPArray", "RNASeq"],
          "description": "Type of sequencing performed"
        },
        "platform": {
          "type": "string",
          "description": "Sequencing platform (e.g., Illumina NovaSeq)"
        },
        "coverage": {
          "type": "number",
          "minimum": 0,
          "description": "Average coverage depth"
        },
        "qualityScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Quality score (Phred)"
        },
        "date": {
          "$ref": "common.schema.json#/$defs/Timestamp"
        },
        "laboratory": {
          "type": "string",
          "description": "Laboratory that performed sequencing"
        },
        "accession": {
          "type": "string",
          "description": "Accession number"
        },
        "referenceGenome": {
          "type": "string",
          "enum": ["GRCh37", "GRCh38", "T2T-CHM13"],
          "description": "Reference genome used for alignment"
        }
      },
      "additionalProperties": false
    },
    "variants": {
      "type": "array",
      "description": "Genetic variants",
      "items": {
        "type": "object",
        "properties": {
          "gene": {
            "type": "string",
            "description": "Gene symbol (HGNC)"
          },
          "rsId": {
            "type": "string",
            "pattern": "^rs\\d+$",
            "description": "dbSNP reference ID"
          },
          "chromosome": {
            "type": "string",
            "pattern": "^(chr)?([1-9]|1[0-9]|2[0-2]|X|Y|MT)$"
          },
          "position": {
            "type": "integer",
            "minimum": 1
          },
          "reference": {
            "type": "string",
            "pattern": "^[ACGT]+$"
          },
          "alternate": {
            "type": "string",
            "pattern": "^[ACGT]+$"
          },
          "zygosity": {
            "type": "string",
            "enum": ["homozygous", "heterozygous", "hemizygous"]
          },
          "clinicalSignificance": {
            "type": "string",
            "enum": [
              "pathogenic",
              "likelyPathogenic",
              "uncertain",
              "likelyBenign",
              "benign"
            ]
          },
          "condition": {
            "type": "string",
            "description": "Associated condition or disease"
          },
          "inheritance": {
            "type": "string",
            "enum": [
              "autosomalDominant",
              "autosomalRecessive",
              "xLinkedDominant",
              "xLinkedRecessive",
              "mitochondrial",
              "multifactorial"
            ]
          },
          "clinvarId": {
            "type": "string"
          },
          "hgvs": {
            "type": "object",
            "properties": {
              "c": {
                "type": "string",
                "description": "Coding DNA notation"
              },
              "p": {
                "type": "string",
                "description": "Protein notation"
              },
              "g": {
                "type": "string",
                "description": "Genomic notation"
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    },
    "pharmacogenomics": {
      "type": "object",
      "description": "Pharmacogenomic profile",
      "properties": {
        "metabolizerStatus": {
          "type": "object",
          "description": "CYP enzyme metabolizer status",
          "patternProperties": {
            "^CYP[0-9A-Z]+$": {
              "type": "string",
              "enum": [
                "poorMetabolizer",
                "intermediateMetabolizer",
                "normalMetabolizer",
                "rapidMetabolizer",
                "ultrarapidMetabolizer"
              ]
            }
          },
          "additionalProperties": false
        },
        "drugResponses": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "drug": {
                "type": "string",
                "description": "Drug name (RxNorm preferred)"
              },
              "gene": {
                "type": "string",
                "description": "Gene symbol"
              },
              "diplotype": {
                "type": "string",
                "description": "Star allele diplotype"
              },
              "phenotype": {
                "type": "string"
              },
              "recommendation": {
                "type": "string"
              },
              "evidenceLevel": {
                "type": "string",
                "enum": ["1A", "1B", "2A", "2B", "3", "4"],
                "description": "CPIC evidence level"
              },
              "source": {
                "type": "string",
                "enum": ["CPIC", "DPWG", "FDA", "PharmGKB"]
              }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "polygeneticRiskScores": {
      "type": "array",
      "description": "Polygenic risk scores",
      "items": {
        "type": "object",
        "properties": {
          "condition": {
            "type": "string",
            "description": "Disease or trait"
          },
          "score": {
            "type": "number"
          },
          "percentile": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
          },
          "riskCategory": {
            "type": "string",
            "enum": ["low", "average", "elevated", "high"]
          },
          "algorithm": {
            "type": "string",
            "description": "PRS algorithm name"
          },
          "snpCount": {
            "type": "integer",
            "minimum": 1,
            "description": "Number of SNPs included"
          },
          "population": {
            "type": "string",
            "description": "Reference population"
          }
        },
        "additionalProperties": false
      }
    },
    "ancestry": {
      "type": "object",
      "description": "Genetic ancestry",
      "properties": {
        "populations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "population": {
                "type": "string"
              },
              "percentage": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              }
            },
            "required": ["population", "percentage"],
            "additionalProperties": false
          }
        },
        "haplogroups": {
          "type": "object",
          "properties": {
            "maternal": {
              "type": "string",
              "description": "Mitochondrial haplogroup"
            },
            "paternal": {
              "type": "string",
              "description": "Y-chromosome haplogroup"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
