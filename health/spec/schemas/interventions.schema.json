{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/health/schemas/interventions.schema.json",
  "title": "WIA Health Intervention History",
  "description": "Longevity interventions and treatments tracking",
  "type": "object",
  "properties": {
    "interventions": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "common.schema.json#/$defs/UUID"
          },
          "category": {
            "type": "string",
            "enum": [
              "pharmaceutical",
              "nutraceutical",
              "lifestyle",
              "procedure",
              "device",
              "genetic",
              "cellTherapy",
              "other"
            ],
            "description": "Category of intervention"
          },
          "name": {
            "type": "string",
            "description": "Intervention name"
          },
          "description": {
            "type": "string"
          },
          "targetMechanism": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "senolytics",
                "senomorphics",
                "telomereExtension",
                "epigeneticReprogramming",
                "mitochondrial",
                "antiInflammatory",
                "metabolic",
                "hormonal",
                "autophagy",
                "proteostasis",
                "stemCell",
                "genomicStability",
                "nutrientSensing",
                "intercellularCommunication"
              ]
            },
            "description": "Targeted aging hallmarks or mechanisms"
          },
          "protocol": {
            "type": "object",
            "properties": {
              "dosage": {
                "type": "string"
              },
              "frequency": {
                "type": "string"
              },
              "duration": {
                "type": "string"
              },
              "route": {
                "type": "string",
                "enum": ["oral", "sublingual", "injection", "infusion", "topical", "inhalation", "implant", "other"]
              },
              "timing": {
                "type": "string",
                "description": "Timing instructions (e.g., with food, morning)"
              },
              "cycling": {
                "type": "string",
                "description": "On/off cycling protocol if applicable"
              }
            },
            "additionalProperties": false
          },
          "startDate": {
            "$ref": "common.schema.json#/$defs/Date"
          },
          "endDate": {
            "$ref": "common.schema.json#/$defs/Date"
          },
          "status": {
            "type": "string",
            "enum": ["planned", "active", "paused", "completed", "discontinued"]
          },
          "prescriber": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "specialty": {
                "type": "string"
              },
              "institution": {
                "type": "string"
              },
              "identifier": {
                "type": "string"
              }
            },
            "additionalProperties": false
          },
          "source": {
            "type": "object",
            "description": "Source/manufacturer information",
            "properties": {
              "manufacturer": {
                "type": "string"
              },
              "lotNumber": {
                "type": "string"
              },
              "expirationDate": {
                "$ref": "common.schema.json#/$defs/Date"
              }
            },
            "additionalProperties": false
          },
          "outcomes": {
            "type": "object",
            "properties": {
              "primaryEndpoint": {
                "type": "object",
                "properties": {
                  "measure": {
                    "type": "string",
                    "description": "Primary outcome measure"
                  },
                  "baseline": {
                    "type": "number"
                  },
                  "final": {
                    "type": "number"
                  },
                  "change": {
                    "type": "number"
                  },
                  "changePercent": {
                    "type": "number"
                  },
                  "significant": {
                    "type": "boolean"
                  },
                  "pValue": {
                    "type": "number"
                  }
                },
                "additionalProperties": false
              },
              "secondaryEndpoints": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "measure": {
                      "type": "string"
                    },
                    "baseline": {
                      "type": "number"
                    },
                    "final": {
                      "type": "number"
                    },
                    "change": {
                      "type": "number"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "subjectiveOutcomes": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "domain": {
                      "type": "string",
                      "enum": ["energy", "sleep", "cognition", "mood", "pain", "mobility", "overall"]
                    },
                    "baselineScore": {
                      "type": "number"
                    },
                    "finalScore": {
                      "type": "number"
                    },
                    "scale": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "adverseEvents": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "event": {
                      "type": "string"
                    },
                    "severity": {
                      "type": "string",
                      "enum": ["mild", "moderate", "severe", "lifeThreatening"]
                    },
                    "category": {
                      "type": "string"
                    },
                    "onsetDate": {
                      "$ref": "common.schema.json#/$defs/Date"
                    },
                    "resolutionDate": {
                      "$ref": "common.schema.json#/$defs/Date"
                    },
                    "resolved": {
                      "type": "boolean"
                    },
                    "actionTaken": {
                      "type": "string",
                      "enum": ["none", "doseReduced", "discontinued", "treated", "hospitalized"]
                    },
                    "relatedness": {
                      "type": "string",
                      "enum": ["unrelated", "unlikely", "possible", "probable", "definite"]
                    }
                  },
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          },
          "monitoring": {
            "type": "object",
            "properties": {
              "schedule": {
                "type": "string"
              },
              "biomarkers": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "lastAssessment": {
                "$ref": "common.schema.json#/$defs/Date"
              },
              "nextAssessment": {
                "$ref": "common.schema.json#/$defs/Date"
              }
            },
            "additionalProperties": false
          },
          "evidence": {
            "type": "object",
            "properties": {
              "level": {
                "type": "string",
                "enum": ["1a", "1b", "2a", "2b", "3", "4", "5"],
                "description": "Evidence level (Oxford CEBM)"
              },
              "grade": {
                "type": "string",
                "enum": ["A", "B", "C", "D"],
                "description": "Recommendation grade"
              },
              "references": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "pmid": {
                      "type": "string"
                    },
                    "doi": {
                      "type": "string"
                    },
                    "title": {
                      "type": "string"
                    },
                    "journal": {
                      "type": "string"
                    },
                    "year": {
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false
                }
              }
            },
            "additionalProperties": false
          },
          "cost": {
            "type": "object",
            "properties": {
              "amount": {
                "type": "number"
              },
              "currency": {
                "type": "string"
              },
              "frequency": {
                "type": "string"
              },
              "coverage": {
                "type": "string",
                "enum": ["selfPay", "partialCoverage", "fullCoverage", "research"]
              }
            },
            "additionalProperties": false
          },
          "notes": {
            "type": "string"
          }
        },
        "required": ["id", "category", "name", "status"],
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
