{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/health/schemas/telomeres.schema.json",
  "title": "WIA Health Telomere Profile",
  "description": "Telomere length measurements and telomerase activity",
  "type": "object",
  "properties": {
    "measurements": {
      "type": "array",
      "description": "Telomere length measurements over time",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "common.schema.json#/$defs/UUID"
          },
          "averageLength": {
            "type": "object",
            "properties": {
              "value": {
                "type": "number",
                "minimum": 0,
                "description": "Average telomere length"
              },
              "unit": {
                "type": "string",
                "enum": ["kilobases", "kb", "TRF", "T/S_ratio"],
                "description": "Unit of measurement"
              }
            },
            "required": ["value", "unit"],
            "additionalProperties": false
          },
          "shortestTelomere": {
            "type": "object",
            "description": "Shortest telomere measurement (if available)",
            "properties": {
              "value": {
                "type": "number",
                "minimum": 0
              },
              "unit": {
                "type": "string",
                "enum": ["kilobases", "kb"]
              },
              "percentile": {
                "type": "number",
                "minimum": 0,
                "maximum": 100,
                "description": "Percentile of telomere length distribution"
              }
            },
            "additionalProperties": false
          },
          "method": {
            "type": "string",
            "enum": ["qPCR", "TRF", "FISH", "FlowFISH", "STELA", "TeSLA", "nanopore"],
            "description": "Measurement method"
          },
          "cellType": {
            "type": "string",
            "enum": [
              "leukocytes",
              "lymphocytes",
              "granulocytes",
              "pbmc",
              "t_cells",
              "b_cells",
              "nk_cells",
              "fibroblasts",
              "other"
            ],
            "description": "Cell type analyzed"
          },
          "timestamp": {
            "$ref": "common.schema.json#/$defs/Timestamp"
          },
          "laboratory": {
            "type": "string"
          },
          "coefficientOfVariation": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "CV% for quality assessment"
          },
          "qualityScore": {
            "type": "string",
            "enum": ["excellent", "good", "acceptable", "poor"]
          }
        },
        "required": ["averageLength", "method", "timestamp"],
        "additionalProperties": false
      }
    },
    "telomeraseActivity": {
      "type": "object",
      "description": "Telomerase enzyme activity",
      "properties": {
        "level": {
          "type": "string",
          "enum": ["undetectable", "low", "normal", "elevated", "high"]
        },
        "quantitative": {
          "type": "number",
          "minimum": 0,
          "description": "Quantitative telomerase activity"
        },
        "unit": {
          "type": "string"
        },
        "method": {
          "type": "string",
          "enum": ["TRAP", "ddTRAP", "qTRAP", "ELISA"],
          "description": "Telomerase activity assay method"
        },
        "cellType": {
          "type": "string"
        },
        "timestamp": {
          "$ref": "common.schema.json#/$defs/Timestamp"
        }
      },
      "additionalProperties": false
    },
    "ageEquivalent": {
      "type": "object",
      "description": "Telomere-based age estimation",
      "properties": {
        "years": {
          "type": "number",
          "minimum": 0,
          "maximum": 150,
          "description": "Telomere age equivalent in years"
        },
        "percentile": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentile compared to age-matched population"
        },
        "category": {
          "type": "string",
          "enum": ["shorter", "average", "longer"],
          "description": "Category relative to age"
        },
        "referencePopulation": {
          "type": "string",
          "description": "Reference population used for comparison"
        },
        "algorithm": {
          "type": "string",
          "description": "Algorithm used for age calculation"
        }
      },
      "additionalProperties": false
    },
    "attritionRate": {
      "type": "object",
      "description": "Telomere shortening rate",
      "properties": {
        "rate": {
          "type": "number",
          "description": "Base pairs lost per year"
        },
        "unit": {
          "type": "string",
          "default": "bp/year"
        },
        "category": {
          "type": "string",
          "enum": ["slow", "normal", "accelerated"]
        },
        "measurementPeriod": {
          "type": "string",
          "description": "Time period over which rate was calculated"
        }
      },
      "additionalProperties": false
    },
    "interventions": {
      "type": "array",
      "description": "Telomere-targeting interventions",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "common.schema.json#/$defs/UUID"
          },
          "type": {
            "type": "string",
            "enum": [
              "telomeraseActivator",
              "geneTherapy",
              "lifestyle",
              "supplement",
              "pharmaceutical"
            ]
          },
          "name": {
            "type": "string",
            "description": "Intervention name (e.g., TA-65, TERT gene therapy)"
          },
          "mechanism": {
            "type": "string",
            "description": "Mechanism of action"
          },
          "startDate": {
            "$ref": "common.schema.json#/$defs/Date"
          },
          "endDate": {
            "$ref": "common.schema.json#/$defs/Date"
          },
          "dosage": {
            "type": "string"
          },
          "frequency": {
            "type": "string"
          },
          "outcome": {
            "type": "object",
            "properties": {
              "lengthChange": {
                "type": "number",
                "description": "Change in telomere length (kb)"
              },
              "percentileChange": {
                "type": "number",
                "description": "Change in age percentile"
              },
              "activityChange": {
                "type": "string",
                "description": "Change in telomerase activity"
              },
              "duration": {
                "type": "string",
                "description": "Duration of effect"
              }
            },
            "additionalProperties": false
          },
          "adverseEvents": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
