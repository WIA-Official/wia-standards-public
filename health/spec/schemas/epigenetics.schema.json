{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.live/health/schemas/epigenetics.schema.json",
  "title": "WIA Health Epigenetic Profile",
  "description": "Epigenetic data including methylation, senescence markers, and reprogramming history",
  "type": "object",
  "properties": {
    "methylationAge": {
      "type": "object",
      "description": "DNA methylation age assessment",
      "properties": {
        "age": {
          "type": "number",
          "minimum": 0,
          "maximum": 150,
          "description": "Calculated methylation age in years"
        },
        "clockType": {
          "type": "string",
          "enum": [
            "horvath",
            "hannum",
            "phenoAge",
            "grimAge",
            "grimAge2",
            "skinBlood",
            "pace",
            "dunedinPACE",
            "custom"
          ],
          "description": "Epigenetic clock type used"
        },
        "tissue": {
          "type": "string",
          "enum": ["blood", "saliva", "skin", "buccal", "adipose", "muscle", "other"],
          "description": "Tissue source for analysis"
        },
        "cpgSites": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of CpG sites analyzed"
        },
        "platform": {
          "type": "string",
          "enum": ["Illumina450K", "IlluminaEPIC", "IlluminaEPICv2", "WGBS", "RRBS", "custom"],
          "description": "Methylation array or sequencing platform"
        },
        "calculatedAt": {
          "$ref": "common.schema.json#/$defs/Timestamp"
        },
        "laboratory": {
          "type": "string"
        },
        "qualityMetrics": {
          "type": "object",
          "properties": {
            "detectionPValue": {
              "type": "number"
            },
            "bisulfiteConversion": {
              "type": "number",
              "minimum": 0,
              "maximum": 100
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "senescenceMarkers": {
      "type": "object",
      "description": "Cellular senescence markers",
      "properties": {
        "p16INK4a": {
          "type": "object",
          "properties": {
            "expression": {
              "type": "number",
              "description": "Expression level"
            },
            "unit": {
              "type": "string",
              "enum": ["relativeExpression", "FPKM", "TPM", "CPM"]
            },
            "method": {
              "type": "string",
              "enum": ["qPCR", "RNAseq", "NanoString", "microarray"]
            },
            "referenceGene": {
              "type": "string",
              "description": "Housekeeping gene for normalization"
            }
          },
          "additionalProperties": false
        },
        "p21CIP1": {
          "type": "object",
          "properties": {
            "expression": {
              "type": "number"
            },
            "unit": {
              "type": "string"
            },
            "method": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "p53": {
          "type": "object",
          "properties": {
            "expression": {
              "type": "number"
            },
            "unit": {
              "type": "string"
            },
            "method": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "senescenceAssociatedBetaGalactosidase": {
          "type": "object",
          "description": "SA-β-gal staining results",
          "properties": {
            "positive": {
              "type": "boolean"
            },
            "percentage": {
              "type": "number",
              "minimum": 0,
              "maximum": 100,
              "description": "Percentage of SA-β-gal positive cells"
            },
            "method": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "sasp": {
          "type": "object",
          "description": "Senescence-Associated Secretory Phenotype markers",
          "properties": {
            "il6": {
              "type": "number"
            },
            "il8": {
              "type": "number"
            },
            "mcp1": {
              "type": "number"
            },
            "mmp3": {
              "type": "number"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "chromatinState": {
      "type": "object",
      "description": "Chromatin accessibility and structure",
      "properties": {
        "globalMethylation": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Global DNA methylation level (%)"
        },
        "lineElements": {
          "type": "number",
          "description": "LINE-1 methylation level"
        },
        "heterochromatinLevel": {
          "type": "string",
          "enum": ["normal", "reduced", "increased"]
        },
        "h3k9me3": {
          "type": "number",
          "description": "H3K9me3 heterochromatin mark level"
        },
        "h3k27me3": {
          "type": "number",
          "description": "H3K27me3 polycomb mark level"
        },
        "atacSeq": {
          "type": "object",
          "description": "ATAC-seq accessibility data",
          "properties": {
            "frip": {
              "type": "number",
              "description": "Fraction of reads in peaks"
            },
            "tssEnrichment": {
              "type": "number",
              "description": "TSS enrichment score"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "reprogrammingHistory": {
      "type": "array",
      "description": "History of cellular reprogramming interventions",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "common.schema.json#/$defs/UUID"
          },
          "date": {
            "$ref": "common.schema.json#/$defs/Timestamp"
          },
          "method": {
            "type": "string",
            "enum": [
              "yamanakaFactors",
              "partialReprogramming",
              "oksm",
              "oskmln",
              "chemicalReprogramming",
              "other"
            ],
            "description": "Reprogramming method used"
          },
          "factors": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["Oct4", "Sox2", "Klf4", "c-Myc", "Lin28", "Nanog", "other"]
            },
            "description": "Transcription factors used"
          },
          "deliveryMethod": {
            "type": "string",
            "enum": ["viral", "mRNA", "plasmid", "protein", "smallMolecule"]
          },
          "duration": {
            "type": "string",
            "description": "Duration of factor expression"
          },
          "cycles": {
            "type": "integer",
            "minimum": 1,
            "description": "Number of reprogramming cycles"
          },
          "outcome": {
            "type": "string",
            "enum": ["successful", "partial", "unsuccessful"]
          },
          "ageReduction": {
            "type": "number",
            "description": "Epigenetic age reduction achieved (years)"
          },
          "sideEffects": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "notes": {
            "type": "string"
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
