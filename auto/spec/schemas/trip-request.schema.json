{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.org/auto/schemas/trip-request.schema.json",
  "title": "WIA Autonomous Vehicle Trip Request",
  "description": "Request for an accessible autonomous vehicle trip",
  "type": "object",
  "required": ["request_id", "version", "timestamp", "trip"],
  "properties": {
    "request_id": {
      "type": "string",
      "format": "uuid"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "passenger_profile_id": {
      "type": "string",
      "format": "uuid"
    },
    "trip": {
      "type": "object",
      "required": ["pickup", "dropoff"],
      "properties": {
        "pickup": {
          "$ref": "#/$defs/Location"
        },
        "dropoff": {
          "$ref": "#/$defs/Location"
        },
        "scheduled_time": {
          "type": ["string", "null"],
          "format": "date-time"
        },
        "flexibility_minutes": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "accessibility_requirements": {
      "type": "object",
      "properties": {
        "wheelchair_accessible": { "type": "boolean" },
        "ramp_required": { "type": "boolean" },
        "lift_required": { "type": "boolean" },
        "service_animal_space": { "type": "boolean" },
        "companion_space": { "type": "integer", "minimum": 0 },
        "preferred_modalities": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "visual_screen", "visual_led", "audio_tts", "audio_chime",
              "audio_speech_rec", "haptic_vibration", "haptic_force",
              "braille", "physical_button"
            ]
          }
        }
      }
    },
    "preferences": {
      "type": "object",
      "properties": {
        "minimize_walking": { "type": "boolean" },
        "audio_guidance": { "type": "boolean" },
        "visual_guidance": { "type": "boolean" },
        "haptic_feedback": { "type": "boolean" },
        "quiet_ride": { "type": "boolean" }
      }
    }
  },
  "$defs": {
    "Location": {
      "type": "object",
      "required": ["location"],
      "properties": {
        "location": {
          "type": "object",
          "required": ["latitude", "longitude"],
          "properties": {
            "latitude": {
              "type": "number",
              "minimum": -90,
              "maximum": 90
            },
            "longitude": {
              "type": "number",
              "minimum": -180,
              "maximum": 180
            },
            "address": { "type": "string" }
          }
        },
        "notes": { "type": "string" },
        "pickup_side": {
          "type": "string",
          "enum": ["same_side", "any"]
        },
        "curb_to_curb": { "type": "boolean" }
      }
    }
  }
}
