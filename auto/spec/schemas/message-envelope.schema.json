{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://wia.org/auto/schemas/message-envelope.schema.json",
  "title": "WIA Autonomous Vehicle Message Envelope",
  "description": "Standard message envelope for WIA Auto data exchange",
  "type": "object",
  "required": ["wia_auto"],
  "properties": {
    "wia_auto": {
      "type": "object",
      "required": ["version", "message_id", "timestamp", "source", "destination", "message_type", "payload"],
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Protocol version"
        },
        "message_id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique message identifier"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Message timestamp in ISO 8601 format"
        },
        "source": {
          "type": "string",
          "enum": ["passenger_app", "vehicle", "fleet_mgmt", "support"],
          "description": "Message source"
        },
        "destination": {
          "type": "string",
          "enum": ["passenger_app", "vehicle", "fleet_mgmt", "support"],
          "description": "Message destination"
        },
        "message_type": {
          "type": "string",
          "enum": [
            "profile",
            "capabilities",
            "trip_request",
            "trip_response",
            "hmi_config",
            "securement",
            "emergency"
          ],
          "description": "Type of payload"
        },
        "correlation_id": {
          "type": "string",
          "format": "uuid",
          "description": "ID to correlate request/response pairs"
        },
        "priority": {
          "type": "string",
          "enum": ["low", "normal", "high", "critical"],
          "default": "normal"
        },
        "payload": {
          "type": "object",
          "description": "Message payload (schema depends on message_type)"
        }
      }
    }
  },
  "examples": [
    {
      "wia_auto": {
        "version": "1.0.0",
        "message_id": "550e8400-e29b-41d4-a716-446655440000",
        "timestamp": "2024-12-16T10:30:00Z",
        "source": "passenger_app",
        "destination": "fleet_mgmt",
        "message_type": "trip_request",
        "priority": "normal",
        "payload": {
          "request_id": "660e8400-e29b-41d4-a716-446655440001",
          "version": "1.0.0",
          "trip": {
            "pickup": {
              "location": {
                "latitude": 37.5665,
                "longitude": 126.9780,
                "address": "서울특별시 중구 세종대로 110"
              }
            },
            "dropoff": {
              "location": {
                "latitude": 37.5796,
                "longitude": 126.9770,
                "address": "서울특별시 종로구 사직로 161"
              }
            }
          },
          "accessibility_requirements": {
            "wheelchair_accessible": true,
            "ramp_required": true
          }
        }
      }
    }
  ]
}
