{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/bio/structure.schema.json",
  "title": "WIA Biotech Protein Structure",
  "description": "Schema for protein structure data",
  "type": "object",
  "required": [
    "structure_id",
    "prediction",
    "protein"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "structure_id": {
      "type": "string",
      "pattern": "^struct-[a-zA-Z0-9-]+$",
      "description": "Unique structure identifier"
    },
    "structure_info": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Structure name"
        },
        "description": {
          "type": "string",
          "description": "Structure description"
        },
        "uniprot_id": {
          "type": "string",
          "description": "UniProt accession ID"
        },
        "pdb_id": {
          "type": ["string", "null"],
          "pattern": "^[0-9][A-Za-z0-9]{3}$",
          "description": "PDB ID (if deposited)"
        }
      }
    },
    "prediction": {
      "type": "object",
      "required": ["method"],
      "properties": {
        "method": {
          "type": "string",
          "enum": [
            "alphafold",
            "alphafold3",
            "rosettafold",
            "esmfold",
            "experimental",
            "homology"
          ],
          "description": "Structure determination method"
        },
        "version": {
          "type": "string",
          "description": "Software/method version"
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "Prediction/determination date"
        },
        "source": {
          "type": "string",
          "enum": [
            "alphafold_db",
            "pdb",
            "local_prediction",
            "custom"
          ],
          "description": "Data source"
        }
      }
    },
    "protein": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Protein name"
        },
        "organism": {
          "type": "string",
          "description": "Source organism"
        },
        "length_aa": {
          "type": "integer",
          "minimum": 1,
          "description": "Protein length in amino acids"
        },
        "molecular_weight_da": {
          "type": "number",
          "description": "Molecular weight in Daltons"
        },
        "sequence_ref": {
          "type": "string",
          "description": "Reference to protein sequence"
        }
      }
    },
    "quality": {
      "type": "object",
      "properties": {
        "mean_plddt": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Mean pLDDT score"
        },
        "confident_residues_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Fraction of residues with pLDDT > 70"
        },
        "disordered_residues_pct": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Fraction of predicted disordered residues"
        },
        "resolution_angstrom": {
          "type": "number",
          "description": "Resolution (for experimental structures)"
        }
      }
    },
    "domains": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Domain name"
          },
          "start": {
            "type": "integer",
            "minimum": 1,
            "description": "Start residue"
          },
          "end": {
            "type": "integer",
            "minimum": 1,
            "description": "End residue"
          },
          "mean_plddt": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Domain mean pLDDT"
          },
          "pfam_id": {
            "type": "string",
            "description": "Pfam domain ID"
          },
          "interpro_id": {
            "type": "string",
            "description": "InterPro ID"
          }
        }
      },
      "description": "Protein domains"
    },
    "ligands": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Ligand name"
          },
          "type": {
            "type": "string",
            "enum": ["small_molecule", "ion", "cofactor", "nucleic_acid", "peptide"],
            "description": "Ligand type"
          },
          "binding_site_residues": {
            "type": "array",
            "items": {"type": "integer"},
            "description": "Binding site residue numbers"
          }
        }
      },
      "description": "Bound ligands"
    },
    "files": {
      "type": "object",
      "properties": {
        "pdb": {
          "type": "string",
          "description": "PDB format file path"
        },
        "mmcif": {
          "type": "string",
          "description": "mmCIF format file path"
        },
        "confidence": {
          "type": "string",
          "description": "Confidence metrics file path"
        }
      }
    }
  }
}
