{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/security/v1/alert.schema.json",
  "title": "WIA Security Alert",
  "description": "Security Alert event type schema",
  "allOf": [
    { "$ref": "wia-security-v1.schema.json" }
  ],
  "properties": {
    "type": {
      "const": "alert"
    },
    "data": {
      "$ref": "#/definitions/AlertData"
    }
  },
  "definitions": {
    "AlertData": {
      "type": "object",
      "required": ["alert_id", "title", "category", "status", "priority"],
      "properties": {
        "alert_id": {
          "type": "string",
          "description": "Unique alert identifier"
        },
        "title": {
          "type": "string",
          "description": "Alert title"
        },
        "description": {
          "type": "string",
          "description": "Alert description"
        },
        "category": {
          "type": "string",
          "enum": ["malware", "intrusion", "policy", "reconnaissance", "other"],
          "description": "Alert category"
        },
        "status": {
          "type": "string",
          "enum": ["new", "investigating", "resolved", "false_positive", "closed"],
          "description": "Alert status"
        },
        "priority": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low", "info"],
          "description": "Alert priority"
        },
        "assignee": {
          "type": "string",
          "description": "Assigned analyst"
        },
        "detection_rule": {
          "type": "object",
          "properties": {
            "id": { "type": "string" },
            "name": { "type": "string" },
            "version": { "type": "string" }
          }
        },
        "indicators": {
          "type": "array",
          "items": {
            "$ref": "wia-security-v1.schema.json#/definitions/Indicator"
          }
        },
        "first_seen": {
          "type": "string",
          "format": "date-time"
        },
        "last_seen": {
          "type": "string",
          "format": "date-time"
        },
        "count": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of occurrences"
        }
      }
    }
  }
}
