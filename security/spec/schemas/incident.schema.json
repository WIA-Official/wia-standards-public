{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/security/v1/incident.schema.json",
  "title": "WIA Security Incident",
  "description": "Security Incident event type schema",
  "allOf": [
    { "$ref": "wia-security-v1.schema.json" }
  ],
  "properties": {
    "type": {
      "const": "incident"
    },
    "data": {
      "$ref": "#/definitions/IncidentData"
    }
  },
  "definitions": {
    "IncidentData": {
      "type": "object",
      "required": ["incident_id", "title", "category", "status", "priority"],
      "properties": {
        "incident_id": {
          "type": "string",
          "description": "Incident identifier"
        },
        "title": {
          "type": "string",
          "description": "Incident title"
        },
        "description": {
          "type": "string",
          "description": "Incident description"
        },
        "category": {
          "type": "string",
          "enum": ["malware", "phishing", "ransomware", "data_breach", "ddos", "unauthorized_access", "insider_threat", "apt", "other"],
          "description": "Incident category"
        },
        "status": {
          "type": "string",
          "enum": ["new", "triaging", "investigating", "containing", "eradicating", "recovering", "closed"],
          "description": "Incident status"
        },
        "priority": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "description": "Incident priority"
        },
        "impact": {
          "type": "object",
          "properties": {
            "availability": {
              "type": "string",
              "enum": ["none", "low", "medium", "high", "critical"]
            },
            "confidentiality": {
              "type": "string",
              "enum": ["none", "low", "medium", "high", "critical"]
            },
            "integrity": {
              "type": "string",
              "enum": ["none", "low", "medium", "high", "critical"]
            },
            "financial": {
              "type": "string",
              "enum": ["unknown", "minimal", "moderate", "significant", "severe"]
            },
            "reputation": {
              "type": "string",
              "enum": ["unknown", "minimal", "moderate", "significant", "severe"]
            }
          }
        },
        "timeline": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["timestamp", "action"],
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time"
              },
              "action": { "type": "string" },
              "actor": { "type": "string" },
              "details": { "type": "string" }
            }
          }
        },
        "affected_assets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["type", "id"],
            "properties": {
              "type": {
                "type": "string",
                "enum": ["host", "server", "network", "application", "database", "user"]
              },
              "id": { "type": "string" },
              "name": { "type": "string" },
              "ip": { "type": "string" },
              "criticality": {
                "type": "string",
                "enum": ["critical", "high", "medium", "low"]
              }
            }
          }
        },
        "iocs": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["type", "value"],
            "properties": {
              "type": {
                "type": "string",
                "enum": ["ip", "domain", "url", "hash", "email"]
              },
              "value": { "type": "string" },
              "description": { "type": "string" },
              "first_seen": {
                "type": "string",
                "format": "date-time"
              }
            }
          }
        },
        "response_actions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["action", "target", "status"],
            "properties": {
              "action": {
                "type": "string",
                "enum": ["isolate_host", "block_ip", "disable_user", "quarantine_file", "collect_forensics"]
              },
              "target": { "type": "string" },
              "status": {
                "type": "string",
                "enum": ["pending", "in_progress", "completed", "failed"]
              },
              "timestamp": {
                "type": "string",
                "format": "date-time"
              },
              "actor": { "type": "string" },
              "notes": { "type": "string" }
            }
          }
        },
        "root_cause": { "type": "string" },
        "lessons_learned": { "type": "string" },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time"
        },
        "closed_at": {
          "type": "string",
          "format": "date-time"
        },
        "lead_analyst": { "type": "string" },
        "team": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    }
  }
}
