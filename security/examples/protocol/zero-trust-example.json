{
  "description": "Zero Trust Access Decision Request/Response Example",
  "request": {
    "$schema": "https://wia.live/schemas/security/protocol/message/v1.schema.json",
    "protocol_version": "1.0.0",
    "message_id": "550e8400-e29b-41d4-a716-446655440000",
    "timestamp": "2024-12-14T10:35:00.000Z",
    "message_type": "request",
    "sender": {
      "id": "pep-gateway-001",
      "type": "pep",
      "name": "API Gateway PEP",
      "certificate_fingerprint": "a3b2c1d0e9f8a7b6c5d4e3f2a1b0c9d8e7f6a5b4c3d2e1f0a9b8c7d6e5f4a3b2"
    },
    "receiver": {
      "id": "pdp-central",
      "type": "pdp",
      "name": "Central Policy Decision Point"
    },
    "security": {
      "encryption": "TLS1.3",
      "signature_algorithm": "Ed25519",
      "signature": "YmFzZTY0LWVuY29kZWQtc2lnbmF0dXJl",
      "nonce": "unique-nonce-12345"
    },
    "payload": {
      "content_type": "application/json",
      "encoding": "utf-8",
      "data": {
        "request_type": "access_decision",
        "subject": {
          "user_id": "user@example.com",
          "device_id": "device-uuid-12345",
          "device_posture": {
            "os_version": "macOS 14.1",
            "patch_level": "2024-12-01",
            "antivirus_status": "up_to_date",
            "disk_encryption": true,
            "firewall_enabled": true,
            "trust_score": 0.92
          },
          "location": {
            "ip": "203.0.113.45",
            "country": "KR",
            "city": "Seoul",
            "network_type": "corporate_vpn"
          },
          "authentication": {
            "method": "mfa",
            "factors": ["password", "totp", "biometric"],
            "auth_time": "2024-12-14T10:30:00Z",
            "session_id": "session-uuid-67890"
          },
          "risk_signals": {
            "impossible_travel": false,
            "unusual_time": false,
            "unusual_device": false,
            "compromised_credential": false,
            "anomaly_score": 0.05
          }
        },
        "resource": {
          "type": "database",
          "id": "customer-db-prod",
          "classification": "confidential",
          "environment": "production",
          "location": "aws-ap-northeast-2"
        },
        "action": "read",
        "context": {
          "request_time": "2024-12-14T10:35:00Z",
          "day_type": "business_day",
          "business_justification": "Customer support ticket #12345"
        }
      }
    },
    "metadata": {
      "priority": "high",
      "ttl_seconds": 30,
      "trace_id": "trace-abc123"
    }
  },
  "response": {
    "$schema": "https://wia.live/schemas/security/protocol/message/v1.schema.json",
    "protocol_version": "1.0.0",
    "message_id": "550e8400-e29b-41d4-a716-446655440001",
    "timestamp": "2024-12-14T10:35:00.015Z",
    "message_type": "response",
    "sender": {
      "id": "pdp-central",
      "type": "pdp"
    },
    "receiver": {
      "id": "pep-gateway-001",
      "type": "pep"
    },
    "security": {
      "encryption": "TLS1.3",
      "signature_algorithm": "Ed25519",
      "signature": "cmVzcG9uc2Utc2lnbmF0dXJl"
    },
    "payload": {
      "content_type": "application/json",
      "data": {
        "status": "success",
        "result": {
          "decision": "permit",
          "decision_id": "decision-uuid-abc123",
          "conditions": [
            {
              "type": "time_limit",
              "constraint": "session_expires_at",
              "value": "2024-12-14T18:35:00Z"
            },
            {
              "type": "continuous_auth",
              "constraint": "reauth_interval_minutes",
              "value": 30
            },
            {
              "type": "data_limit",
              "constraint": "max_records_per_query",
              "value": 1000
            }
          ],
          "obligations": [
            {
              "type": "logging",
              "action": "log_all_queries",
              "target": "siem-central",
              "parameters": {
                "detail_level": "verbose",
                "include_results": false
              }
            },
            {
              "type": "alerting",
              "action": "alert_on_anomaly",
              "condition": "query_count > 100 in 5 minutes",
              "target": "soc-team"
            },
            {
              "type": "masking",
              "action": "mask_pii",
              "parameters": {
                "fields": ["ssn", "credit_card", "phone"]
              }
            }
          ],
          "valid_from": "2024-12-14T10:35:00Z",
          "valid_until": "2024-12-14T18:35:00Z",
          "session_token": "eyJhbGciOiJFZDI1NTE5...encrypted-token"
        }
      }
    },
    "metadata": {
      "correlation_id": "550e8400-e29b-41d4-a716-446655440000",
      "processing_time_ms": 15
    }
  }
}
