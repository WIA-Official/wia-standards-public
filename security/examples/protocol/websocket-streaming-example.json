{
  "description": "WebSocket Real-Time Streaming Protocol Example",
  "subscribe_request": {
    "action": "subscribe",
    "subscriptions": [
      {
        "channel": "alerts",
        "filters": {
          "severity": ["critical", "high"],
          "categories": ["malware", "intrusion", "data_exfiltration"]
        }
      },
      {
        "channel": "threat_intel",
        "filters": {
          "ioc_types": ["ip", "domain", "file_hash"]
        }
      },
      {
        "channel": "policy_decisions",
        "filters": {
          "decision": ["deny"]
        }
      }
    ]
  },
  "subscribe_response": {
    "action": "subscribed",
    "subscription_id": "sub-550e8400-e29b-41d4-a716",
    "channels": ["alerts", "threat_intel", "policy_decisions"],
    "connected_at": "2024-12-14T10:00:00.000Z",
    "config": {
      "heartbeat_interval_seconds": 30,
      "rate_limit_per_second": 100,
      "max_message_size": 1048576
    }
  },
  "event_examples": [
    {
      "action": "event",
      "channel": "alerts",
      "sequence": 12345,
      "timestamp": "2024-12-14T10:35:00.000Z",
      "event": {
        "type": "alert",
        "severity": 9,
        "title": "Ransomware Activity Detected",
        "data": {
          "alert_id": "ALERT-2024-12345",
          "description": "Suspected LockBit ransomware activity detected on web-server-03",
          "category": "malware",
          "status": "new",
          "priority": "critical",
          "source": {
            "host": "web-server-03",
            "ip": "10.0.1.50",
            "user": "www-data"
          },
          "indicators": [
            {
              "type": "file_hash",
              "value": "a3f8b2c1e4d5f6a7b8c9d0e1f2a3b4c5",
              "context": "Ransomware executable"
            },
            {
              "type": "ip",
              "value": "45.142.212.61",
              "context": "C2 server"
            }
          ],
          "mitre_attack": {
            "tactic": "TA0040",
            "tactic_name": "Impact",
            "technique": "T1486",
            "technique_name": "Data Encrypted for Impact"
          },
          "recommended_actions": [
            "Isolate affected host immediately",
            "Block C2 IP at firewall",
            "Initiate incident response procedure",
            "Preserve forensic evidence"
          ]
        }
      }
    },
    {
      "action": "event",
      "channel": "threat_intel",
      "sequence": 12346,
      "timestamp": "2024-12-14T10:35:05.000Z",
      "event": {
        "type": "ioc_update",
        "severity": 8,
        "title": "New APT29 IOCs Added",
        "data": {
          "source": "WIA Threat Intel Feed",
          "threat_actor": "APT29",
          "aliases": ["Cozy Bear", "The Dukes"],
          "new_indicators": [
            {
              "type": "domain",
              "value": "update-service.example.com",
              "confidence": 0.95
            },
            {
              "type": "ip",
              "value": "185.220.101.45",
              "confidence": 0.90
            }
          ],
          "kill_chain_phase": "command-and-control"
        }
      }
    },
    {
      "action": "event",
      "channel": "policy_decisions",
      "sequence": 12347,
      "timestamp": "2024-12-14T10:35:10.000Z",
      "event": {
        "type": "access_denied",
        "severity": 6,
        "title": "Suspicious Access Attempt Blocked",
        "data": {
          "decision_id": "decision-uuid-xyz789",
          "decision": "deny",
          "subject": {
            "user_id": "suspicious-user@external.com",
            "device_id": "unknown-device"
          },
          "resource": {
            "type": "database",
            "id": "financial-db-prod"
          },
          "action": "read",
          "deny_reasons": [
            "Unknown device",
            "Failed MFA verification",
            "High-risk location (TOR exit node)"
          ],
          "risk_signals": {
            "impossible_travel": true,
            "compromised_credential": true,
            "anomaly_score": 0.95
          }
        }
      }
    }
  ],
  "heartbeat": {
    "action": "heartbeat",
    "timestamp": "2024-12-14T10:35:30.000Z",
    "server_time": "2024-12-14T10:35:30.123Z"
  },
  "close_message": {
    "action": "close",
    "reason": "server_maintenance",
    "message": "Scheduled maintenance starting. Please reconnect in 5 minutes.",
    "reconnect_allowed": true,
    "reconnect_delay_seconds": 300
  }
}
