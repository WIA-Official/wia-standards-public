{
  "description": "TAXII 2.1 Compatible Threat Intelligence Sharing Example",
  "discovery": {
    "request": {
      "method": "GET",
      "url": "/taxii2/",
      "headers": {
        "Accept": "application/taxii+json;version=2.1",
        "Authorization": "Bearer <token>"
      }
    },
    "response": {
      "title": "WIA Security Threat Intelligence Platform",
      "description": "TAXII 2.1 compatible threat intelligence sharing service",
      "contact": "security@wia.live",
      "api_roots": [
        "https://threat-intel.wia.live/taxii2/api/v1/"
      ],
      "default": "https://threat-intel.wia.live/taxii2/api/v1/"
    }
  },
  "collections": {
    "request": {
      "method": "GET",
      "url": "/taxii2/api/v1/collections/",
      "headers": {
        "Accept": "application/taxii+json;version=2.1"
      }
    },
    "response": {
      "collections": [
        {
          "id": "collection-wia-indicators",
          "title": "WIA Threat Indicators",
          "description": "Real-time threat indicators from WIA Security network",
          "alias": "wia-ioc",
          "can_read": true,
          "can_write": false,
          "media_types": [
            "application/stix+json;version=2.1"
          ]
        },
        {
          "id": "collection-wia-malware",
          "title": "WIA Malware Analysis",
          "description": "Malware analysis reports and samples",
          "alias": "wia-malware",
          "can_read": true,
          "can_write": false,
          "media_types": [
            "application/stix+json;version=2.1"
          ]
        },
        {
          "id": "collection-community",
          "title": "Community Shared Intelligence",
          "description": "Community-contributed threat intelligence",
          "alias": "community",
          "can_read": true,
          "can_write": true,
          "media_types": [
            "application/stix+json;version=2.1"
          ]
        }
      ]
    }
  },
  "objects": {
    "request": {
      "method": "GET",
      "url": "/taxii2/api/v1/collections/collection-wia-indicators/objects/",
      "headers": {
        "Accept": "application/stix+json;version=2.1"
      },
      "query_params": {
        "added_after": "2024-12-13T00:00:00Z",
        "limit": 100
      }
    },
    "response": {
      "more": true,
      "next": "2024-12-14T10:00:00.000Z",
      "objects": [
        {
          "type": "indicator",
          "spec_version": "2.1",
          "id": "indicator--550e8400-e29b-41d4-a716-446655440010",
          "created": "2024-12-14T10:00:00.000Z",
          "modified": "2024-12-14T10:00:00.000Z",
          "name": "Malicious IP - APT29 C2 Server",
          "description": "Command and control server used in recent APT29 campaign targeting government entities",
          "pattern": "[ipv4-addr:value = '185.220.101.45']",
          "pattern_type": "stix",
          "valid_from": "2024-12-14T10:00:00.000Z",
          "valid_until": "2025-01-14T10:00:00.000Z",
          "kill_chain_phases": [
            {
              "kill_chain_name": "mitre-attack",
              "phase_name": "command-and-control"
            }
          ],
          "indicator_types": ["malicious-activity"],
          "confidence": 90,
          "labels": ["apt29", "cozy-bear", "c2"],
          "external_references": [
            {
              "source_name": "MITRE ATT&CK",
              "url": "https://attack.mitre.org/groups/G0016/",
              "external_id": "G0016"
            }
          ]
        },
        {
          "type": "indicator",
          "spec_version": "2.1",
          "id": "indicator--550e8400-e29b-41d4-a716-446655440011",
          "created": "2024-12-14T09:30:00.000Z",
          "modified": "2024-12-14T09:30:00.000Z",
          "name": "LockBit Ransomware File Hash",
          "description": "SHA-256 hash of LockBit 3.0 ransomware sample",
          "pattern": "[file:hashes.'SHA-256' = 'a3f8b2c1e4d5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1']",
          "pattern_type": "stix",
          "valid_from": "2024-12-14T09:30:00.000Z",
          "kill_chain_phases": [
            {
              "kill_chain_name": "mitre-attack",
              "phase_name": "impact"
            }
          ],
          "indicator_types": ["malicious-activity"],
          "confidence": 95,
          "labels": ["ransomware", "lockbit"]
        },
        {
          "type": "threat-actor",
          "spec_version": "2.1",
          "id": "threat-actor--550e8400-e29b-41d4-a716-446655440020",
          "created": "2024-12-14T08:00:00.000Z",
          "modified": "2024-12-14T08:00:00.000Z",
          "name": "APT29",
          "description": "APT29 is a threat group that has been attributed to the Russian government",
          "aliases": ["Cozy Bear", "The Dukes", "YTTRIUM", "Iron Hemlock"],
          "threat_actor_types": ["nation-state"],
          "roles": ["spy"],
          "goals": ["espionage", "data-theft"],
          "sophistication": "expert",
          "resource_level": "government",
          "primary_motivation": "espionage"
        },
        {
          "type": "malware",
          "spec_version": "2.1",
          "id": "malware--550e8400-e29b-41d4-a716-446655440030",
          "created": "2024-12-14T08:00:00.000Z",
          "modified": "2024-12-14T08:00:00.000Z",
          "name": "LockBit 3.0",
          "description": "LockBit 3.0 ransomware variant with enhanced encryption",
          "malware_types": ["ransomware"],
          "is_family": true,
          "kill_chain_phases": [
            {
              "kill_chain_name": "mitre-attack",
              "phase_name": "execution"
            },
            {
              "kill_chain_name": "mitre-attack",
              "phase_name": "impact"
            }
          ]
        },
        {
          "type": "relationship",
          "spec_version": "2.1",
          "id": "relationship--550e8400-e29b-41d4-a716-446655440040",
          "created": "2024-12-14T10:00:00.000Z",
          "modified": "2024-12-14T10:00:00.000Z",
          "relationship_type": "indicates",
          "source_ref": "indicator--550e8400-e29b-41d4-a716-446655440010",
          "target_ref": "threat-actor--550e8400-e29b-41d4-a716-446655440020",
          "description": "This IP indicator indicates APT29 activity"
        }
      ]
    }
  },
  "add_objects": {
    "request": {
      "method": "POST",
      "url": "/taxii2/api/v1/collections/collection-community/objects/",
      "headers": {
        "Accept": "application/taxii+json;version=2.1",
        "Content-Type": "application/stix+json;version=2.1"
      },
      "body": {
        "objects": [
          {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--new-indicator-uuid",
            "created": "2024-12-14T12:00:00.000Z",
            "modified": "2024-12-14T12:00:00.000Z",
            "name": "Phishing Domain",
            "pattern": "[domain-name:value = 'login-security-update.com']",
            "pattern_type": "stix",
            "valid_from": "2024-12-14T12:00:00.000Z",
            "indicator_types": ["malicious-activity"],
            "confidence": 80
          }
        ]
      }
    },
    "response": {
      "id": "status--550e8400-e29b-41d4-a716-446655440050",
      "status": "complete",
      "request_timestamp": "2024-12-14T12:00:00.000Z",
      "total_count": 1,
      "success_count": 1,
      "failure_count": 0,
      "pending_count": 0
    }
  }
}
