{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-official.github.io/wia-standards/ci/schemas/octave-result.schema.json",
  "title": "WIA CI Octave Detection Result",
  "description": "Result of pitch/octave detection using OctaveYIN algorithm",
  "type": "object",
  "required": ["fundamental_frequency", "octave", "note", "confidence"],
  "properties": {
    "fundamental_frequency": {
      "type": "number",
      "minimum": 20,
      "maximum": 20000,
      "description": "Detected fundamental frequency in Hz"
    },
    "octave": {
      "type": "integer",
      "minimum": 0,
      "maximum": 9,
      "description": "Musical octave number (4 = middle C octave)"
    },
    "note": {
      "type": "string",
      "enum": ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"],
      "description": "Musical note name"
    },
    "cents": {
      "type": "integer",
      "minimum": -50,
      "maximum": 50,
      "description": "Deviation from nearest semitone in cents"
    },
    "confidence": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Detection confidence (0.0 = no confidence, 1.0 = highest confidence)"
    },
    "harmonics": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/HarmonicInfo"
      },
      "description": "Detected harmonics"
    },
    "determination_method": {
      "type": "string",
      "enum": ["YINDirect", "HarmonicAnalysis", "SubharmonicVerification"],
      "description": "Method used to determine octave"
    }
  },
  "definitions": {
    "HarmonicInfo": {
      "type": "object",
      "required": ["harmonic_number", "frequency", "relative_amplitude"],
      "properties": {
        "harmonic_number": {
          "type": "integer",
          "minimum": 1,
          "maximum": 16,
          "description": "Harmonic number (1 = fundamental)"
        },
        "frequency": {
          "type": "number",
          "minimum": 0,
          "description": "Frequency of this harmonic in Hz"
        },
        "relative_amplitude": {
          "type": "number",
          "minimum": 0,
          "description": "Amplitude relative to fundamental"
        }
      }
    }
  },
  "examples": [
    {
      "fundamental_frequency": 440.0,
      "octave": 4,
      "note": "A",
      "cents": 0,
      "confidence": 0.95,
      "harmonics": [
        { "harmonic_number": 1, "frequency": 440.0, "relative_amplitude": 1.0 },
        { "harmonic_number": 2, "frequency": 880.0, "relative_amplitude": 0.5 },
        { "harmonic_number": 3, "frequency": 1320.0, "relative_amplitude": 0.33 }
      ],
      "determination_method": "HarmonicAnalysis"
    }
  ]
}
