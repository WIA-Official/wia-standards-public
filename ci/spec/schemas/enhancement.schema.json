{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-official.github.io/wia-standards/ci/schemas/enhancement.schema.json",
  "title": "WIA CI Enhancement Result",
  "description": "Enhanced CI signal with octave encoding",
  "type": "object",
  "required": ["electrodes", "octave_info", "metadata"],
  "properties": {
    "electrodes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ElectrodeEnhancement"
      },
      "minItems": 1,
      "maxItems": 22,
      "description": "Enhanced electrode activation data"
    },
    "octave_info": {
      "$ref": "#/definitions/OctaveEncodingInfo"
    },
    "metadata": {
      "$ref": "#/definitions/EnhancementMetadata"
    }
  },
  "definitions": {
    "ElectrodeEnhancement": {
      "type": "object",
      "required": ["electrode_id", "original_amplitude", "enhanced_amplitude"],
      "properties": {
        "electrode_id": {
          "type": "integer",
          "minimum": 1,
          "maximum": 22,
          "description": "Electrode ID"
        },
        "original_amplitude": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Original amplitude before enhancement"
        },
        "enhanced_amplitude": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Enhanced amplitude after octave encoding"
        },
        "temporal_modulation": {
          "$ref": "#/definitions/TemporalModulation"
        }
      }
    },
    "TemporalModulation": {
      "type": "object",
      "required": ["frequency", "depth", "phase"],
      "properties": {
        "frequency": {
          "type": "number",
          "minimum": 1,
          "maximum": 100,
          "description": "Modulation frequency in Hz (encodes octave)"
        },
        "depth": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Modulation depth"
        },
        "phase": {
          "type": "number",
          "minimum": 0,
          "maximum": 6.283185307,
          "description": "Current phase in radians"
        }
      }
    },
    "OctaveEncodingInfo": {
      "type": "object",
      "required": ["octave", "fundamental_frequency", "encoding_methods"],
      "properties": {
        "octave": {
          "type": "integer",
          "minimum": 0,
          "maximum": 9,
          "description": "Detected octave"
        },
        "fundamental_frequency": {
          "type": "number",
          "minimum": 0,
          "description": "Fundamental frequency in Hz"
        },
        "encoding_methods": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["temporal_modulation", "electrode_pattern", "harmonic_enhancement"]
          },
          "description": "Methods used for octave encoding"
        },
        "encoding_confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Confidence in encoding accuracy"
        }
      }
    },
    "EnhancementMetadata": {
      "type": "object",
      "properties": {
        "processing_time_ms": {
          "type": "number",
          "minimum": 0,
          "description": "Processing time in milliseconds"
        },
        "config_used": {
          "type": "string",
          "description": "Configuration string used"
        },
        "version": {
          "type": "string",
          "description": "Enhancement algorithm version"
        }
      }
    }
  },
  "examples": [
    {
      "electrodes": [
        {
          "electrode_id": 7,
          "original_amplitude": 0.6,
          "enhanced_amplitude": 0.72,
          "temporal_modulation": {
            "frequency": 10.0,
            "depth": 0.3,
            "phase": 1.57
          }
        }
      ],
      "octave_info": {
        "octave": 4,
        "fundamental_frequency": 440.0,
        "encoding_methods": ["temporal_modulation", "electrode_pattern"],
        "encoding_confidence": 0.9
      },
      "metadata": {
        "processing_time_ms": 0.5,
        "config_used": "default",
        "version": "0.1.0"
      }
    }
  ]
}
