{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia-official.github.io/wia-standards/ci/schemas/wia-ci-signal-v1.schema.json",
  "title": "WIA CI Signal",
  "description": "Cochlear Implant signal data format for WIA CI Octave Enhancement",
  "type": "object",
  "required": ["version", "signal_type", "device", "timestamp", "sample_rate", "electrodes"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "examples": ["1.0.0"]
    },
    "signal_type": {
      "type": "string",
      "enum": ["raw", "processed", "enhanced"],
      "description": "Type of CI signal"
    },
    "device": {
      "$ref": "#/definitions/DeviceInfo"
    },
    "timestamp": {
      "type": "integer",
      "description": "Timestamp in milliseconds",
      "minimum": 0
    },
    "sample_rate": {
      "type": "integer",
      "description": "Sample rate in Hz",
      "minimum": 8000,
      "maximum": 96000,
      "examples": [16000, 44100]
    },
    "electrodes": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ElectrodeActivation"
      },
      "minItems": 1,
      "maxItems": 22,
      "description": "Electrode activation data"
    },
    "analysis": {
      "$ref": "#/definitions/SignalAnalysis"
    }
  },
  "definitions": {
    "DeviceInfo": {
      "type": "object",
      "required": ["manufacturer", "model", "strategy", "channels"],
      "properties": {
        "manufacturer": {
          "type": "string",
          "enum": ["Cochlear", "MED-EL", "Advanced Bionics", "Oticon Medical", "Other"],
          "description": "CI manufacturer"
        },
        "model": {
          "type": "string",
          "description": "Device model name",
          "examples": ["Nucleus 8", "SONNET 2", "Marvel CI"]
        },
        "strategy": {
          "type": "string",
          "enum": ["CIS", "ACE", "SPEAK", "FSP", "FS4", "HiRes", "Other"],
          "description": "Sound processing strategy"
        },
        "channels": {
          "type": "integer",
          "minimum": 1,
          "maximum": 22,
          "description": "Number of active channels/electrodes"
        }
      }
    },
    "ElectrodeActivation": {
      "type": "object",
      "required": ["id", "frequency", "amplitude", "pulse_rate", "pulse_width"],
      "properties": {
        "id": {
          "type": "integer",
          "minimum": 1,
          "maximum": 22,
          "description": "Electrode ID (1=apex/low freq, 22=base/high freq)"
        },
        "frequency": {
          "$ref": "#/definitions/FrequencyRange"
        },
        "amplitude": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Normalized amplitude (0.0 - 1.0)"
        },
        "pulse_rate": {
          "type": "integer",
          "minimum": 250,
          "maximum": 3500,
          "description": "Pulse rate in Hz",
          "examples": [900, 1200]
        },
        "pulse_width": {
          "type": "integer",
          "minimum": 10,
          "maximum": 100,
          "description": "Pulse width in microseconds",
          "examples": [25, 37]
        }
      }
    },
    "FrequencyRange": {
      "type": "object",
      "required": ["min", "max", "center"],
      "properties": {
        "min": {
          "type": "number",
          "minimum": 0,
          "description": "Minimum frequency in Hz"
        },
        "max": {
          "type": "number",
          "minimum": 0,
          "description": "Maximum frequency in Hz"
        },
        "center": {
          "type": "number",
          "minimum": 0,
          "description": "Center frequency in Hz"
        }
      }
    },
    "SignalAnalysis": {
      "type": "object",
      "properties": {
        "dominant_frequency": {
          "type": "number",
          "description": "Dominant frequency in Hz"
        },
        "estimated_pitch": {
          "type": "string",
          "description": "Estimated musical pitch",
          "examples": ["A4", "C5"]
        },
        "octave": {
          "type": "integer",
          "minimum": 0,
          "maximum": 9,
          "description": "Octave number"
        },
        "confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Detection confidence"
        }
      }
    }
  }
}
