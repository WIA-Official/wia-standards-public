{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/schemas/ai/tool.schema.json",
  "title": "WIA AI Tool",
  "description": "Schema for WIA AI tool definitions",
  "type": "object",
  "required": [
    "name",
    "description",
    "parameters"
  ],
  "properties": {
    "$schema": {
      "type": "string",
      "format": "uri"
    },
    "name": {
      "type": "string",
      "pattern": "^[a-z][a-z0-9_]*$",
      "description": "Tool name (lowercase with underscores)"
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of the tool"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "category": {
      "type": "string",
      "enum": [
        "web",
        "file",
        "code",
        "data",
        "communication",
        "search",
        "analysis",
        "generation",
        "utility",
        "custom"
      ]
    },
    "parameters": {
      "type": "object",
      "required": ["type", "properties"],
      "properties": {
        "type": {
          "type": "string",
          "const": "object"
        },
        "required": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "properties": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/parameter"
          }
        }
      }
    },
    "returns": {
      "type": "object",
      "description": "Schema for the return value",
      "properties": {
        "type": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "properties": {
          "type": "object"
        },
        "items": {
          "type": "object"
        }
      }
    },
    "errors": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/error"
      },
      "description": "Possible errors this tool can return"
    },
    "examples": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/example"
      }
    },
    "constraints": {
      "type": "object",
      "properties": {
        "requires_confirmation": {
          "type": "boolean",
          "default": false
        },
        "rate_limit": {
          "type": "object",
          "properties": {
            "calls_per_minute": {
              "type": "integer"
            },
            "calls_per_hour": {
              "type": "integer"
            }
          }
        },
        "timeout_seconds": {
          "type": "integer"
        },
        "max_retries": {
          "type": "integer"
        }
      }
    },
    "permissions": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "read_file",
          "write_file",
          "execute_code",
          "network_access",
          "system_access",
          "database_access",
          "api_access"
        ]
      }
    },
    "implementation": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["builtin", "mcp", "http", "function", "script"]
        },
        "endpoint": {
          "type": "string"
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST", "PUT", "DELETE", "PATCH"]
        },
        "mcp_server": {
          "type": "string"
        },
        "function": {
          "type": "string"
        }
      }
    }
  },
  "definitions": {
    "parameter": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["string", "number", "integer", "boolean", "array", "object", "null"]
        },
        "description": {
          "type": "string"
        },
        "default": {
          "description": "Default value"
        },
        "enum": {
          "type": "array",
          "description": "Allowed values"
        },
        "minimum": {
          "type": "number"
        },
        "maximum": {
          "type": "number"
        },
        "minLength": {
          "type": "integer"
        },
        "maxLength": {
          "type": "integer"
        },
        "pattern": {
          "type": "string"
        },
        "format": {
          "type": "string",
          "enum": ["date", "date-time", "email", "uri", "uuid", "hostname", "ipv4", "ipv6"]
        },
        "items": {
          "type": "object",
          "description": "Schema for array items"
        },
        "properties": {
          "type": "object",
          "description": "Schema for object properties"
        }
      }
    },
    "error": {
      "type": "object",
      "required": ["code", "message"],
      "properties": {
        "code": {
          "type": "string"
        },
        "message": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      }
    },
    "example": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "input": {
          "type": "object"
        },
        "output": {
          "description": "Expected output"
        }
      }
    }
  }
}
