{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wia.live/material/v1/programmable-matter.schema.json",
  "title": "WIA Material - Programmable Matter",
  "description": "Schema for programmable matter and claytronics",
  "allOf": [
    { "$ref": "wia-material-v1.schema.json" }
  ],
  "properties": {
    "material_type": {
      "const": "programmable_matter"
    },
    "properties": {
      "type": "object",
      "properties": {
        "domain_specific": {
          "type": "object",
          "properties": {
            "system_type": {
              "type": "string",
              "enum": ["claytronics", "modular_robotics", "smart_material", "nanotech"],
              "description": "Type of programmable matter system"
            },
            "ensemble_id": {
              "type": "string",
              "description": "Ensemble or assembly identifier"
            },
            "target_shape": {
              "type": "string",
              "description": "Target shape or configuration"
            },
            "module_count": {
              "type": "integer",
              "minimum": 1,
              "description": "Total number of modules"
            },
            "shape_accuracy_percent": {
              "type": "number",
              "minimum": 0,
              "maximum": 100,
              "description": "Current shape accuracy percentage"
            },
            "reconfiguration_time_s": {
              "type": "number",
              "minimum": 0,
              "description": "Time to reconfigure in seconds"
            },
            "modules": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "module_id": {
                    "type": "string",
                    "description": "Module identifier"
                  },
                  "module_type": {
                    "type": "string",
                    "description": "Type of module (e.g., catom)"
                  },
                  "position": {
                    "type": "object",
                    "properties": {
                      "x": { "type": "number" },
                      "y": { "type": "number" },
                      "z": { "type": "number" }
                    },
                    "required": ["x", "y", "z"],
                    "description": "3D position in micrometers"
                  },
                  "orientation": {
                    "type": "object",
                    "properties": {
                      "roll": { "type": "number" },
                      "pitch": { "type": "number" },
                      "yaw": { "type": "number" }
                    },
                    "description": "Orientation in degrees"
                  },
                  "bonds": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "IDs of bonded modules"
                  },
                  "power_state": {
                    "type": "string",
                    "enum": ["active", "idle", "off"],
                    "description": "Power state"
                  },
                  "energy_level_percent": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 100,
                    "description": "Energy level percentage"
                  }
                }
              },
              "description": "List of individual modules"
            },
            "capabilities": {
              "type": "object",
              "properties": {
                "locomotion": { "type": "boolean" },
                "bonding": { "type": "boolean" },
                "communication": { "type": "boolean" },
                "computation": { "type": "boolean" },
                "color_change": { "type": "boolean" },
                "shape_change": { "type": "boolean" }
              },
              "description": "Module capabilities"
            },
            "physical_properties": {
              "type": "object",
              "properties": {
                "module_diameter_um": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Module diameter in micrometers"
                },
                "module_mass_ug": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Module mass in micrograms"
                },
                "bonding_force_uN": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Bonding force in micronewtons"
                },
                "max_speed_um_s": {
                  "type": "number",
                  "minimum": 0,
                  "description": "Maximum speed in micrometers per second"
                }
              }
            },
            "actuation_method": {
              "type": "string",
              "enum": ["electrostatic", "magnetic", "pneumatic", "thermal", "piezoelectric"],
              "description": "Actuation mechanism"
            }
          }
        }
      }
    }
  }
}
